import { Component, EventEmitter, Input, Output } from '@angular/core';
import { Subject } from 'rxjs';
import { TimetableConstants } from './timetable.constant';
import * as _ from "lodash";
import * as i0 from "@angular/core";
import * as i1 from "@angular/forms";
import * as i2 from "@ngx-translate/core";
import * as i3 from "@angular/common";
import * as i4 from "ngx-drag-drop";
import * as i5 from "ng-select2";
import * as i6 from "@ng-bootstrap/ng-bootstrap";
export class TimetableComponent {
    constructor(fb, translate) {
        this.fb = fb;
        this.translate = translate;
        this.objectKeys = Object.keys;
        this.SEMESTERS = {
            FIRST: 'FIRST',
            SECOND: 'SECOND',
            ALL: 'ALL'
        };
        this.semesters = Object.keys(this.SEMESTERS);
        this.solverStatusMessage = null;
        this.destroyed$ = new Subject();
        this.MODE = {
            EDIT: 'edit',
            NEW: 'new'
        };
        this.debug = false;
        this.isEnableAdjustMode = false;
        this.showProgressLoading = false;
        this.onRemoveAction = new EventEmitter();
        this.onDropAcion = new EventEmitter();
        this.onCellClickAction = new EventEmitter();
        this.onCreateNewLession = new EventEmitter();
        this.activeLessions = [];
        this.activeTeachManagement = undefined;
        this.daysOfWeek = [
            "MONDAY",
            "TUESDAY",
            "WEDNESDAY",
            "THURSDAY",
            "FRIDAY",
            "SATURDAY",
            "SUNDAY",
        ];
        this.draggable = {
            data: null,
            effectAllowed: "all",
            disable: true,
            handle: false
        };
        this.timeTableData = {};
        this.isAutoUpdateClassIds = false;
        this.selectedClasses = [];
        this.classListSelectedDefault = [];
        this.teachManagements = [];
        this.dayLessionSlots = [...Array(5).keys()];
        this.CALLBACK_TIME = 5000;
        this.checkingGenerateProgresser = null;
        this.isDisabledPlanning = false;
        this.slotNumOfDay = [];
        this.TIMETABLE_EDIT_MODE = TimetableConstants.TIMETABLE_EDIT_MODE;
        this.FORM_FIELDS = {
            MAJOR: 'majorCode',
            TUTOR: 'tutorUuid',
            CLASS_ID: 'classId',
            SEMESTER: 'semester'
        };
        this.form = this.fb.group({
            [this.FORM_FIELDS.MAJOR]: [{ value: -1 }],
            [this.FORM_FIELDS.TUTOR]: [{ value: '' }]
        });
        this.translate.setDefaultLang('vn');
    }
    ngOnChanges(changes) {
        if (this.debug) {
            console.log("__TIMETABLE_PROPS:", changes);
        }
        if (changes['timeShift']?.currentValue) {
            this.buildTimeTableBasic();
        }
        if (changes['timeslots']?.currentValue) {
            this.initTimetableSlot();
        }
        if (changes['isEnableAdjustMode']?.currentValue) {
            this.draggable = {
                ...this.draggable,
                disable: !this.isEnableAdjustMode
            };
        }
        if (changes['filterForm']?.currentValue) {
            this.filterFormChanges();
        }
        if (changes['lessions']?.currentValue) {
            this.mappingDataToTable();
        }
    }
    filterFormChanges() {
        if (!this.filterForm?.classIds?.length) {
            this.resetTimeTable();
        }
    }
    initTimetableSlot() {
        const alltimeslot = this.timeslots;
        this.daysOfWeek.forEach((day) => {
            const slotsOfDay = alltimeslot.filter((slot) => slot.dayOfWeek === day && slot.timeShift === this.timeShift);
            this.timeTableData[day] = {
                items: _.orderBy(slotsOfDay, ["order"]),
            };
            const maxLession = this.getMaxlessionOrder(slotsOfDay);
            this.slotNumOfDay = [...Array(maxLession).keys()];
        });
    }
    getMaxlessionOrder(timeSlot) {
        return _.maxBy(timeSlot, (o) => { return o.order; })?.order || 10;
    }
    buildTimeTableBasic() {
        this.daysOfWeek.forEach((day) => {
            this.timeTableData[day] = {
                items: [],
            };
        });
    }
    mappingDataToTable() {
        this.daysOfWeek.forEach((day) => {
            const slotsOfDay = this.lessions.filter((slot) => slot.dayOfWeek === day);
            this.timeTableData[day] = {
                items: _.orderBy(slotsOfDay, ["order"]),
            };
        });
    }
    getLessonByOrder(day, index, timeShift) {
        return this.timeTableData[day].items.filter((item) => {
            const found = item.order === index && item?.timeShift === timeShift;
            return found;
        });
    }
    resetTimeTable() {
        this.buildTimeTableBasic();
    }
    onClickTutorName(tutor) {
        window.open(`/tutors/${tutor.uuid}`, '_blank');
    }
    getActiveGradeName() {
        return _.find(this.grades, (item) => item.code === this.filterForm['gradeCode'])?.title;
    }
    onDrop(event, day, slotNum, timeShift) {
        const dropSlot = this.getSlot(day, slotNum);
        const dropLession = {
            "id": _.get(event, "data.details.id", 0),
            "schoolYear": _.get(event, "data.details.schoolYear", 0),
            "semester": _.get(event, "data.details.semester", 0),
            timeslotId: dropSlot.id,
            timetableProblemId: this.timetableProblemId,
            "tutor": _.get(event, "data.details.tutor", null),
            "major": _.get(event, "data.details.major", null),
            "clazz": _.get(event, "data.details.clazz", null),
        };
        const payload = [dropLession];
        let currentLession = _.get(this.getLessonByOrder(day, slotNum, timeShift), "0", null);
        if (currentLession) {
            currentLession = {
                "id": _.get(currentLession, "details.id", 0),
                "schoolYear": _.get(currentLession, "details.schoolYear", 0),
                "semester": _.get(currentLession, "details.semester", 0),
                timeslotId: _.get(event, "data.details.timeslot.id", 0),
                timetableProblemId: this.timetableProblemId,
                "tutor": _.get(currentLession, "details.tutor", null),
                "major": _.get(currentLession, "details.major", null),
                "clazz": _.get(currentLession, "details.clazz", null),
            };
            payload.push(currentLession);
        }
        this.onDropAcion.emit(payload);
    }
    changeOnOffSwitch($event) {
        this.isEnableAdjustMode = $event.target.checked;
        this.draggable = {
            ...this.draggable,
            disable: !this.isEnableAdjustMode
        };
    }
    getSlot(day, order) {
        const slot = this.timeslots.find((slot) => slot.dayOfWeek === day && slot.timeShift === this.timeShift && slot.order === order);
        return slot;
    }
    getSlotByOrder(day, index) {
        return this.timeTableData[day].items.filter((item) => item.order === index);
    }
    onCellClick(p, day, slotNum, timeShift) {
        this.activeSlot = this.getSlot(day, slotNum);
        this.activeTeachManagement = null;
        if (!this.isEnableAdjustMode || !this.activeSlot.enabled)
            return;
        this.activeLessions = this.getLessonByOrder(day, slotNum, timeShift);
        p.open();
        if (!this.activeLessions?.length) {
            this.mode = this.MODE.NEW;
            this.activeFormDialog = p;
            this.onCellClickAction.emit(this.activeLessions);
        }
        else {
            this.mode = this.MODE.EDIT;
        }
    }
    onSelectTeachManagement($event) {
        this.activeTeachManagement = this.majorsTranscript.find((item) => item.code === $event);
    }
    getMajor() {
        return {
            "code": _.get(this.activeTeachManagement, 'teachManagement.majorCode', 0),
            "name": _.get(this.activeTeachManagement, 'teachManagement.majorName', 0),
        };
    }
    getTutor() {
        return {
            "uuid": _.get(this.activeTeachManagement, 'teachManagement.tutorUuid', 0),
            "name": _.get(this.activeTeachManagement, 'teachManagement.tutorName', 0)
        };
    }
    getClazz() {
        return {
            "code": _.get(this.activeTeachManagement, 'teachManagement.classId', 0),
            "name": _.get(this.activeTeachManagement, 'teachManagement.className', 0),
            "gradeCode": _.get(this.activeTeachManagement, 'teachManagement.gradeCode', 0),
        };
    }
    createNewLession() {
        if (!this.form.valid)
            return;
        const payload = {
            "schoolYear": this.schoolYear,
            "semester": this.filterForm.semester,
            "timeslotId": this.activeSlot?.id,
            "timetableProblemId": this.timetableProblemId,
            "tutor": this.getTutor(),
            "major": this.getMajor(),
            "clazz": this.getClazz()
        };
        this.onCreateNewLession.emit(payload);
    }
    get isAssignedTutor() {
        return this.activeTeachManagement && this.activeTeachManagement?.teachManagement?.tutorName;
    }
    get isUnAssignedTutor() {
        return this.activeTeachManagement && !this.activeTeachManagement?.teachManagement?.tutorName;
    }
    closeForm() {
        this.activeFormDialog.close();
    }
    removeLessionFromCell() {
        const activeLession = this.activeLessions[0];
        this.onRemoveAction.emit(activeLession);
    }
    ngOnDestroy() {
        this.destroyed$.next();
        this.destroyed$.complete();
        this.resetTimeTable();
    }
}
TimetableComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: TimetableComponent, deps: [{ token: i1.UntypedFormBuilder }, { token: i2.TranslateService }], target: i0.ɵɵFactoryTarget.Component });
TimetableComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.9", type: TimetableComponent, selector: "tada-ngx-timetable", inputs: { debug: "debug", filterForm: "filterForm", timeShift: "timeShift", schoolYear: "schoolYear", type: "type", grades: "grades", lessions: "lessions", timetableProblemId: "timetableProblemId", majorsTranscript: "majorsTranscript", timeslots: "timeslots", isEnableAdjustMode: "isEnableAdjustMode", showProgressLoading: "showProgressLoading", popUpContent: "popUpContent" }, outputs: { onRemoveAction: "onRemoveAction", onDropAcion: "onDropAcion", onCellClickAction: "onCellClickAction", onCreateNewLession: "onCreateNewLession" }, usesOnChanges: true, ngImport: i0, template: "<div class=\"timetable-ui\" [class.in-processing]=\"showProgressLoading\">\n  <div class=\"timetable-ui-prefix-column timetable-ui-day-column\">\n    <div class=\"timetable-ui-day-column-lesson\">\n      <div\n        class=\"timetable-ui-day-lesson-item\"\n        *ngFor=\"let lessonNum of dayLessionSlots\"\n      >\n        <div>\n          <span>Ti\u1EBFt {{ lessonNum + 1 }}</span>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div\n    *ngFor=\"let day of objectKeys(timeTableData)\"\n    class=\"timetable-ui-day-column\"\n  >\n    <div class=\"timetable-ui-day-column-lesson\">\n      <div class=\"timetable-ui-day-name\">\n        {{ day | translate }}\n      </div>\n      <div\n        class=\"timetable-ui-day-lesson-item timetable-ui-day-lesson-item-value\"\n        *ngFor=\"let slotNum of dayLessionSlots\"\n      >\n        <div\n          dndDropzone\n          [class.tbl-editing-mode]=\"isEnableAdjustMode\"\n          (dndDrop)=\"onDrop($event, day, slotNum + 1, timeShift)\"\n          [ngbPopover]=\"popContent\"\n          [autoClose]=\"'outside'\"\n          triggers=\"manual\"\n          #p=\"ngbPopover\"\n          placement=\"auto\"\n          class=\"timetable-ui-cell-container\"\n          [class.empty-lession]=\"\n            !getLessonByOrder(day, slotNum + 1, timeShift)?.length\n          \"\n          [class.is-disabled]=\"!getSlot(day, slotNum + 1)?.enabled\"\n          (click)=\"onCellClick(p, day, slotNum + 1, timeShift)\"\n        >\n          <div class=\"dnd-dropzone-slot\" dndPlaceholderRef></div>\n          <div\n            *ngFor=\"let lesson of getLessonByOrder(day, slotNum + 1, timeShift)\"\n            class=\"timetable-ui-day-lesson-item__item\"\n            [dndDraggable]=\"lesson\"\n            [dndDisableIf]=\"draggable.disable\"\n          >\n            <div>\n              <h4>{{ lesson?.details?.major.name }}</h4>\n              <p\n                class=\"sub-text-one\"\n                (click)=\"onClickTutorName(lesson.details.tutor)\"\n              >\n                <ng-container *ngIf=\"type === 'TUTOR'\">{{\n                  lesson?.details?.clazz.name\n                }}</ng-container>\n                <ng-container *ngIf=\"type === 'CLASS'\">{{\n                  lesson?.details?.tutor.name\n                }}</ng-container>\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n<ng-template #popContent>\n  <div class=\"schedule-pop-content\" *ngIf=\"mode == MODE.NEW\">\n    <div class=\"mb-1\">\n      <div class=\"schedule-pop-content-header\">\n        <span>Th\u00EAm ti\u1EBFt m\u1EDBi</span>\n      </div>\n      <div class=\"schedule-pop-content-line mb-2\"></div>\n      <form [formGroup]=\"form\" class=\"form\" (ngSubmit)=\"createNewLession()\">\n        <div class=\"form-group\">\n          <label class=\"required\">M\u00F4n h\u1ECDc</label>\n\n          <div class=\"d-block\">\n            <ng-select2\n              formControlName=\"majorCode\"\n              class=\"w-100\"\n              width=\"100%\"\n              (valueChanged)=\"onSelectTeachManagement($event)\"\n            >\n              <option value=\"-1\">Vui l\u00F2ng ch\u1ECDn</option>\n              <option\n                *ngFor=\"let item of majorsTranscript\"\n                value=\"{{ item.code }}\"\n              >\n                {{ item.title }}\n              </option>\n            </ng-select2>\n          </div>\n        </div>\n\n        <div class=\"form-group\" *ngIf=\"isAssignedTutor\">\n          <p class=\"sub-text-one\">\n            Gi\u00E1o vi\u00EAn: {{ activeTeachManagement?.teachManagement?.tutorName }}\n          </p>\n        </div>\n\n        <p class=\"unassigned_tutor\" *ngIf=\"isUnAssignedTutor\">\n          Gi\u00E1o vi\u00EAn: Ch\u01B0a \u0111\u01B0\u1EE3c ph\u00E2n c\u00F4ng.\n        </p>\n\n        <div class=\"buttons\">\n          <button\n            type=\"submit\"\n            [disabled]=\"!isAssignedTutor\"\n            color=\"primary\"\n            class=\"btn btn-primary\"\n          >\n\t\t\t\t\t\tL\u01B0u thay \u0111\u1ED5i\n          </button>\n          <button\n            color=\"primary\"\n            type=\"button\"\n            class=\"btn\"\n            (click)=\"closeForm()\"\n          >\n\t\t\t\t\t\tH\u1EE7y\n          </button>\n        </div>\n      </form>\n    </div>\n  </div>\n\n  <ng-container *ngIf=\"mode == MODE.EDIT\">\n    <span (click)=\"removeLessionFromCell()\" role=\"button\" class=\"d-block remove-lession\">\n      <svg\n        width=\"14\"\n        height=\"14\"\n        viewBox=\"0 0 14 14\"\n        fill=\"none\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n      >\n        <path\n          d=\"M5.75 2.25V2.5H8.25V2.25C8.25 1.91848 8.1183 1.60054 7.88388 1.36612C7.64946 1.1317 7.33152 1 7 1C6.66848 1 6.35054 1.1317 6.11612 1.36612C5.8817 1.60054 5.75 1.91848 5.75 2.25ZM4.75 2.5V2.25C4.75 1.65326 4.98705 1.08097 5.40901 0.65901C5.83097 0.237053 6.40326 0 7 0C7.59674 0 8.16903 0.237053 8.59099 0.65901C9.01295 1.08097 9.25 1.65326 9.25 2.25V2.5H13C13.1326 2.5 13.2598 2.55268 13.3536 2.64645C13.4473 2.74021 13.5 2.86739 13.5 3C13.5 3.13261 13.4473 3.25979 13.3536 3.35355C13.2598 3.44732 13.1326 3.5 13 3.5H12.246L11.3 11.784C11.2302 12.3941 10.9384 12.9572 10.4801 13.3659C10.0218 13.7746 9.42907 14.0003 8.815 14H5.185C4.57093 14.0003 3.97823 13.7746 3.51993 13.3659C3.06162 12.9572 2.76976 12.3941 2.7 11.784L1.754 3.5H1C0.867392 3.5 0.740215 3.44732 0.646447 3.35355C0.552678 3.25979 0.5 3.13261 0.5 3C0.5 2.86739 0.552678 2.74021 0.646447 2.64645C0.740215 2.55268 0.867392 2.5 1 2.5H4.75ZM3.694 11.67C3.73574 12.036 3.91068 12.3738 4.18546 12.619C4.46025 12.8643 4.81567 12.9999 5.184 13H8.8155C9.18383 12.9999 9.53926 12.8643 9.81404 12.619C10.0888 12.3738 10.2638 12.036 10.3055 11.67L11.24 3.5H2.7605L3.694 11.67ZM5.5 5.25C5.63261 5.25 5.75979 5.30268 5.85355 5.39645C5.94732 5.49021 6 5.61739 6 5.75V10.75C6 10.8826 5.94732 11.0098 5.85355 11.1036C5.75979 11.1973 5.63261 11.25 5.5 11.25C5.36739 11.25 5.24021 11.1973 5.14645 11.1036C5.05268 11.0098 5 10.8826 5 10.75V5.75C5 5.61739 5.05268 5.49021 5.14645 5.39645C5.24021 5.30268 5.36739 5.25 5.5 5.25ZM9 5.75C9 5.61739 8.94732 5.49021 8.85355 5.39645C8.75979 5.30268 8.63261 5.25 8.5 5.25C8.36739 5.25 8.24021 5.30268 8.14645 5.39645C8.05268 5.49021 8 5.61739 8 5.75V10.75C8 10.8826 8.05268 11.0098 8.14645 11.1036C8.24021 11.1973 8.36739 11.25 8.5 11.25C8.63261 11.25 8.75979 11.1973 8.85355 11.1036C8.94732 11.0098 9 10.8826 9 10.75V5.75Z\"\n          fill=\"#D93A3A\"\n        />\n      </svg>\n\n      Xo\u00E1 ti\u1EBFt\n    </span>\n  </ng-container>\n</ng-template>\n", styles: [".timetable-ui-prefix-column{width:65px!important}.timetable-ui-prefix-column span{display:block;width:60px}.timetable-ui-prefix-column .timetable-ui-day-lesson-item{font-weight:600;font-size:12px;line-height:12px;position:relative;text-align:center;color:#737579}.timetable-ui-prefix-column .timetable-ui-day-lesson-item:first-child{border-top:none;margin-top:40px}.timetable-ui-prefix-column .timetable-ui-day-lesson-item:first-child>div{border-top:none}.timetable-ui{flex:1;display:flex;flex-direction:row;justify-content:space-between;border:1px solid #e2e8f0;overflow:inherit!important}.timetable-ui .timetable-ui-day-name{text-align:center;padding:10px 8px;width:100%;border:1px solid #e2e8f0}.timetable-ui .timetable-ui-day-column{width:100%}.timetable-ui.in-processing .timetable-ui-day-lesson-item-value .timetable-ui-day-lesson-item__item{opacity:.65}.timetable-ui .timetable-ui-day-column-lesson{display:flex;flex-direction:column}.timetable-ui .timetable-ui-day-column-lesson>.timetable-ui-day-lesson-item{position:relative}.timetable-ui .timetable-ui-day-column-lesson>.timetable-ui-day-lesson-item>div{padding:10px;height:58px;display:block;line-height:20px;width:100%;text-align:center;border:1px solid #e2e8f0;display:flex;align-items:center;justify-content:center}.timetable-ui .timetable-ui-day-column-lesson>.timetable-ui-day-lesson-item>div:hover{border-color:#999}.timetable-ui .timetable-ui-day-column-lesson>.timetable-ui-day-lesson-item>div.is-disabled{cursor:not-allowed!important}.timetable-ui .timetable-ui-day-column-lesson>.timetable-ui-day-lesson-item>div div.timetable-ui-day-lesson-item__item h4{width:100%;overflow:hidden;text-overflow:ellipsis;margin:0;color:#000;font-weight:700;font-size:12px}.timetable-ui .timetable-ui-day-column-lesson>.timetable-ui-day-lesson-item>div div.timetable-ui-day-lesson-item__item .sub-text-one{font-weight:400;font-size:12px;cursor:pointer;line-height:20px;margin:0;text-align:center;font-style:normal;color:#737579}.timetable__academic-year .mat-select{width:200px!important;margin:0 10px}.timetable__grade .mat-select{width:120px!important;margin:0 10px}.timetable__class .multi-select{margin:0 10px;width:200px!important}.timetable__semester--options{width:120px!important}.timetable__semester .mat-select{width:120px!important;margin:0 10px}h4.timeshift_title{font-size:14px;color:#2c2c2c;font-weight:600;text-align:center;margin:0;display:block}.timetable-timeshift-section-heading{padding:16px 8px;color:#737579;margin:0;display:block;align-items:center;background:#f5f5f5;display:flex;flex-direction:row;justify-content:space-between}.timetable-timeshift-section-heading .custom-control-label{font-weight:500;font-size:14px;letter-spacing:.01em;color:#000}.dnd-dropzone-slot{border:1px orangered solid;border-radius:5px;padding:15px;position:absolute;inset:5px}.tbl-editing-mode.empty-lession{background-color:#f8f8f8}.tbl-editing-mode.empty-lession:hover{background-color:#fafafa}.schedule-pop-content{width:301px;padding:6px}.schedule-pop-content h4{font-weight:700;font-size:12px;margin-bottom:5px;line-height:22px;color:#000;padding-bottom:8px;border-bottom:1px solid #eaeaea}.schedule-pop-content .schedule-pop-content-header{border-bottom:1px solid #eaeaea;margin-bottom:5px;padding-bottom:16px}.schedule-pop-content .schedule-pop-content-header span{font-style:normal;font-weight:700;font-size:14px;line-height:16px;text-align:center;letter-spacing:.01em;color:#000}.schedule-pop-content .schedule-pop-content-links{display:flex;flex-direction:row;gap:16px}.schedule-pop-content .schedule-pop-content-links span{font-weight:700;white-space:nowrap;font-size:12px;cursor:pointer;line-height:22px;text-decoration-line:underline;color:#1e88e5}.schedule-pop-content .class-online-label{font-weight:700;font-size:12px;line-height:22px;color:#999;text-decoration-line:underline}.schedule-pop-content .class-online-label.is-on{cursor:pointer;color:#1e88e5!important}::ng-deep .popover{max-width:498px;background:#ffffff;border:none;box-shadow:0 8px 12px #091e4226,0 0 1px #091e424f;border-radius:5px;color:#000}::ng-deep .popover p{color:#000}::ng-deep .popover p.sub-text-one{color:#737579}::ng-deep .popover p.unassigned_tutor{font-weight:400;font-size:14px;line-height:18px;color:#d93a3a}::ng-deep .popover .remove-icon{height:auto;width:18px;line-height:0}.btn{padding:11px 12px;gap:10px;width:102px;height:40px;border-radius:5px;cursor:pointer;background:none;color:#4b49ac;font-style:normal;font-weight:500;font-size:14px;white-space:nowrap;line-height:18px;font-family:Roboto}.btn.btn-primary{background:#4B49AC;color:#fff}.remove-lession{color:#d93a3a}\n"], dependencies: [{ kind: "directive", type: i3.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i3.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i4.DndDraggableDirective, selector: "[dndDraggable]", inputs: ["dndDraggable", "dndEffectAllowed", "dndType", "dndDraggingClass", "dndDraggingSourceClass", "dndDraggableDisabledClass", "dndDragImageOffsetFunction", "dndDisableIf", "dndDisableDragIf"], outputs: ["dndStart", "dndDrag", "dndEnd", "dndMoved", "dndCopied", "dndLinked", "dndCanceled"] }, { kind: "directive", type: i4.DndDropzoneDirective, selector: "[dndDropzone]", inputs: ["dndDropzone", "dndEffectAllowed", "dndAllowExternal", "dndHorizontal", "dndDragoverClass", "dndDropzoneDisabledClass", "dndDisableIf", "dndDisableDropIf"], outputs: ["dndDragover", "dndDrop"] }, { kind: "directive", type: i4.DndPlaceholderRefDirective, selector: "[dndPlaceholderRef]" }, { kind: "component", type: i5.NgSelect2Component, selector: "ng-select2", inputs: ["data", "placeholder", "dropdownParent", "allowClear", "value", "width", "disabled", "id", "class", "required", "options"], outputs: ["valueChanged"] }, { kind: "directive", type: i1.ɵNgNoValidate, selector: "form:not([ngNoForm]):not([ngNativeValidate])" }, { kind: "directive", type: i1.NgSelectOption, selector: "option", inputs: ["ngValue", "value"] }, { kind: "directive", type: i1.ɵNgSelectMultipleOption, selector: "option", inputs: ["ngValue", "value"] }, { kind: "directive", type: i1.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i1.NgControlStatusGroup, selector: "[formGroupName],[formArrayName],[ngModelGroup],[formGroup],form:not([ngNoForm]),[ngForm]" }, { kind: "directive", type: i1.FormGroupDirective, selector: "[formGroup]", inputs: ["formGroup"], outputs: ["ngSubmit"], exportAs: ["ngForm"] }, { kind: "directive", type: i1.FormControlName, selector: "[formControlName]", inputs: ["formControlName", "disabled", "ngModel"], outputs: ["ngModelChange"] }, { kind: "directive", type: i6.NgbPopover, selector: "[ngbPopover]", inputs: ["animation", "autoClose", "ngbPopover", "popoverTitle", "placement", "popperOptions", "triggers", "positionTarget", "container", "disablePopover", "popoverClass", "openDelay", "closeDelay"], outputs: ["shown", "hidden"], exportAs: ["ngbPopover"] }, { kind: "pipe", type: i2.TranslatePipe, name: "translate" }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.9", ngImport: i0, type: TimetableComponent, decorators: [{
            type: Component,
            args: [{ selector: 'tada-ngx-timetable', template: "<div class=\"timetable-ui\" [class.in-processing]=\"showProgressLoading\">\n  <div class=\"timetable-ui-prefix-column timetable-ui-day-column\">\n    <div class=\"timetable-ui-day-column-lesson\">\n      <div\n        class=\"timetable-ui-day-lesson-item\"\n        *ngFor=\"let lessonNum of dayLessionSlots\"\n      >\n        <div>\n          <span>Ti\u1EBFt {{ lessonNum + 1 }}</span>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div\n    *ngFor=\"let day of objectKeys(timeTableData)\"\n    class=\"timetable-ui-day-column\"\n  >\n    <div class=\"timetable-ui-day-column-lesson\">\n      <div class=\"timetable-ui-day-name\">\n        {{ day | translate }}\n      </div>\n      <div\n        class=\"timetable-ui-day-lesson-item timetable-ui-day-lesson-item-value\"\n        *ngFor=\"let slotNum of dayLessionSlots\"\n      >\n        <div\n          dndDropzone\n          [class.tbl-editing-mode]=\"isEnableAdjustMode\"\n          (dndDrop)=\"onDrop($event, day, slotNum + 1, timeShift)\"\n          [ngbPopover]=\"popContent\"\n          [autoClose]=\"'outside'\"\n          triggers=\"manual\"\n          #p=\"ngbPopover\"\n          placement=\"auto\"\n          class=\"timetable-ui-cell-container\"\n          [class.empty-lession]=\"\n            !getLessonByOrder(day, slotNum + 1, timeShift)?.length\n          \"\n          [class.is-disabled]=\"!getSlot(day, slotNum + 1)?.enabled\"\n          (click)=\"onCellClick(p, day, slotNum + 1, timeShift)\"\n        >\n          <div class=\"dnd-dropzone-slot\" dndPlaceholderRef></div>\n          <div\n            *ngFor=\"let lesson of getLessonByOrder(day, slotNum + 1, timeShift)\"\n            class=\"timetable-ui-day-lesson-item__item\"\n            [dndDraggable]=\"lesson\"\n            [dndDisableIf]=\"draggable.disable\"\n          >\n            <div>\n              <h4>{{ lesson?.details?.major.name }}</h4>\n              <p\n                class=\"sub-text-one\"\n                (click)=\"onClickTutorName(lesson.details.tutor)\"\n              >\n                <ng-container *ngIf=\"type === 'TUTOR'\">{{\n                  lesson?.details?.clazz.name\n                }}</ng-container>\n                <ng-container *ngIf=\"type === 'CLASS'\">{{\n                  lesson?.details?.tutor.name\n                }}</ng-container>\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n<ng-template #popContent>\n  <div class=\"schedule-pop-content\" *ngIf=\"mode == MODE.NEW\">\n    <div class=\"mb-1\">\n      <div class=\"schedule-pop-content-header\">\n        <span>Th\u00EAm ti\u1EBFt m\u1EDBi</span>\n      </div>\n      <div class=\"schedule-pop-content-line mb-2\"></div>\n      <form [formGroup]=\"form\" class=\"form\" (ngSubmit)=\"createNewLession()\">\n        <div class=\"form-group\">\n          <label class=\"required\">M\u00F4n h\u1ECDc</label>\n\n          <div class=\"d-block\">\n            <ng-select2\n              formControlName=\"majorCode\"\n              class=\"w-100\"\n              width=\"100%\"\n              (valueChanged)=\"onSelectTeachManagement($event)\"\n            >\n              <option value=\"-1\">Vui l\u00F2ng ch\u1ECDn</option>\n              <option\n                *ngFor=\"let item of majorsTranscript\"\n                value=\"{{ item.code }}\"\n              >\n                {{ item.title }}\n              </option>\n            </ng-select2>\n          </div>\n        </div>\n\n        <div class=\"form-group\" *ngIf=\"isAssignedTutor\">\n          <p class=\"sub-text-one\">\n            Gi\u00E1o vi\u00EAn: {{ activeTeachManagement?.teachManagement?.tutorName }}\n          </p>\n        </div>\n\n        <p class=\"unassigned_tutor\" *ngIf=\"isUnAssignedTutor\">\n          Gi\u00E1o vi\u00EAn: Ch\u01B0a \u0111\u01B0\u1EE3c ph\u00E2n c\u00F4ng.\n        </p>\n\n        <div class=\"buttons\">\n          <button\n            type=\"submit\"\n            [disabled]=\"!isAssignedTutor\"\n            color=\"primary\"\n            class=\"btn btn-primary\"\n          >\n\t\t\t\t\t\tL\u01B0u thay \u0111\u1ED5i\n          </button>\n          <button\n            color=\"primary\"\n            type=\"button\"\n            class=\"btn\"\n            (click)=\"closeForm()\"\n          >\n\t\t\t\t\t\tH\u1EE7y\n          </button>\n        </div>\n      </form>\n    </div>\n  </div>\n\n  <ng-container *ngIf=\"mode == MODE.EDIT\">\n    <span (click)=\"removeLessionFromCell()\" role=\"button\" class=\"d-block remove-lession\">\n      <svg\n        width=\"14\"\n        height=\"14\"\n        viewBox=\"0 0 14 14\"\n        fill=\"none\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n      >\n        <path\n          d=\"M5.75 2.25V2.5H8.25V2.25C8.25 1.91848 8.1183 1.60054 7.88388 1.36612C7.64946 1.1317 7.33152 1 7 1C6.66848 1 6.35054 1.1317 6.11612 1.36612C5.8817 1.60054 5.75 1.91848 5.75 2.25ZM4.75 2.5V2.25C4.75 1.65326 4.98705 1.08097 5.40901 0.65901C5.83097 0.237053 6.40326 0 7 0C7.59674 0 8.16903 0.237053 8.59099 0.65901C9.01295 1.08097 9.25 1.65326 9.25 2.25V2.5H13C13.1326 2.5 13.2598 2.55268 13.3536 2.64645C13.4473 2.74021 13.5 2.86739 13.5 3C13.5 3.13261 13.4473 3.25979 13.3536 3.35355C13.2598 3.44732 13.1326 3.5 13 3.5H12.246L11.3 11.784C11.2302 12.3941 10.9384 12.9572 10.4801 13.3659C10.0218 13.7746 9.42907 14.0003 8.815 14H5.185C4.57093 14.0003 3.97823 13.7746 3.51993 13.3659C3.06162 12.9572 2.76976 12.3941 2.7 11.784L1.754 3.5H1C0.867392 3.5 0.740215 3.44732 0.646447 3.35355C0.552678 3.25979 0.5 3.13261 0.5 3C0.5 2.86739 0.552678 2.74021 0.646447 2.64645C0.740215 2.55268 0.867392 2.5 1 2.5H4.75ZM3.694 11.67C3.73574 12.036 3.91068 12.3738 4.18546 12.619C4.46025 12.8643 4.81567 12.9999 5.184 13H8.8155C9.18383 12.9999 9.53926 12.8643 9.81404 12.619C10.0888 12.3738 10.2638 12.036 10.3055 11.67L11.24 3.5H2.7605L3.694 11.67ZM5.5 5.25C5.63261 5.25 5.75979 5.30268 5.85355 5.39645C5.94732 5.49021 6 5.61739 6 5.75V10.75C6 10.8826 5.94732 11.0098 5.85355 11.1036C5.75979 11.1973 5.63261 11.25 5.5 11.25C5.36739 11.25 5.24021 11.1973 5.14645 11.1036C5.05268 11.0098 5 10.8826 5 10.75V5.75C5 5.61739 5.05268 5.49021 5.14645 5.39645C5.24021 5.30268 5.36739 5.25 5.5 5.25ZM9 5.75C9 5.61739 8.94732 5.49021 8.85355 5.39645C8.75979 5.30268 8.63261 5.25 8.5 5.25C8.36739 5.25 8.24021 5.30268 8.14645 5.39645C8.05268 5.49021 8 5.61739 8 5.75V10.75C8 10.8826 8.05268 11.0098 8.14645 11.1036C8.24021 11.1973 8.36739 11.25 8.5 11.25C8.63261 11.25 8.75979 11.1973 8.85355 11.1036C8.94732 11.0098 9 10.8826 9 10.75V5.75Z\"\n          fill=\"#D93A3A\"\n        />\n      </svg>\n\n      Xo\u00E1 ti\u1EBFt\n    </span>\n  </ng-container>\n</ng-template>\n", styles: [".timetable-ui-prefix-column{width:65px!important}.timetable-ui-prefix-column span{display:block;width:60px}.timetable-ui-prefix-column .timetable-ui-day-lesson-item{font-weight:600;font-size:12px;line-height:12px;position:relative;text-align:center;color:#737579}.timetable-ui-prefix-column .timetable-ui-day-lesson-item:first-child{border-top:none;margin-top:40px}.timetable-ui-prefix-column .timetable-ui-day-lesson-item:first-child>div{border-top:none}.timetable-ui{flex:1;display:flex;flex-direction:row;justify-content:space-between;border:1px solid #e2e8f0;overflow:inherit!important}.timetable-ui .timetable-ui-day-name{text-align:center;padding:10px 8px;width:100%;border:1px solid #e2e8f0}.timetable-ui .timetable-ui-day-column{width:100%}.timetable-ui.in-processing .timetable-ui-day-lesson-item-value .timetable-ui-day-lesson-item__item{opacity:.65}.timetable-ui .timetable-ui-day-column-lesson{display:flex;flex-direction:column}.timetable-ui .timetable-ui-day-column-lesson>.timetable-ui-day-lesson-item{position:relative}.timetable-ui .timetable-ui-day-column-lesson>.timetable-ui-day-lesson-item>div{padding:10px;height:58px;display:block;line-height:20px;width:100%;text-align:center;border:1px solid #e2e8f0;display:flex;align-items:center;justify-content:center}.timetable-ui .timetable-ui-day-column-lesson>.timetable-ui-day-lesson-item>div:hover{border-color:#999}.timetable-ui .timetable-ui-day-column-lesson>.timetable-ui-day-lesson-item>div.is-disabled{cursor:not-allowed!important}.timetable-ui .timetable-ui-day-column-lesson>.timetable-ui-day-lesson-item>div div.timetable-ui-day-lesson-item__item h4{width:100%;overflow:hidden;text-overflow:ellipsis;margin:0;color:#000;font-weight:700;font-size:12px}.timetable-ui .timetable-ui-day-column-lesson>.timetable-ui-day-lesson-item>div div.timetable-ui-day-lesson-item__item .sub-text-one{font-weight:400;font-size:12px;cursor:pointer;line-height:20px;margin:0;text-align:center;font-style:normal;color:#737579}.timetable__academic-year .mat-select{width:200px!important;margin:0 10px}.timetable__grade .mat-select{width:120px!important;margin:0 10px}.timetable__class .multi-select{margin:0 10px;width:200px!important}.timetable__semester--options{width:120px!important}.timetable__semester .mat-select{width:120px!important;margin:0 10px}h4.timeshift_title{font-size:14px;color:#2c2c2c;font-weight:600;text-align:center;margin:0;display:block}.timetable-timeshift-section-heading{padding:16px 8px;color:#737579;margin:0;display:block;align-items:center;background:#f5f5f5;display:flex;flex-direction:row;justify-content:space-between}.timetable-timeshift-section-heading .custom-control-label{font-weight:500;font-size:14px;letter-spacing:.01em;color:#000}.dnd-dropzone-slot{border:1px orangered solid;border-radius:5px;padding:15px;position:absolute;inset:5px}.tbl-editing-mode.empty-lession{background-color:#f8f8f8}.tbl-editing-mode.empty-lession:hover{background-color:#fafafa}.schedule-pop-content{width:301px;padding:6px}.schedule-pop-content h4{font-weight:700;font-size:12px;margin-bottom:5px;line-height:22px;color:#000;padding-bottom:8px;border-bottom:1px solid #eaeaea}.schedule-pop-content .schedule-pop-content-header{border-bottom:1px solid #eaeaea;margin-bottom:5px;padding-bottom:16px}.schedule-pop-content .schedule-pop-content-header span{font-style:normal;font-weight:700;font-size:14px;line-height:16px;text-align:center;letter-spacing:.01em;color:#000}.schedule-pop-content .schedule-pop-content-links{display:flex;flex-direction:row;gap:16px}.schedule-pop-content .schedule-pop-content-links span{font-weight:700;white-space:nowrap;font-size:12px;cursor:pointer;line-height:22px;text-decoration-line:underline;color:#1e88e5}.schedule-pop-content .class-online-label{font-weight:700;font-size:12px;line-height:22px;color:#999;text-decoration-line:underline}.schedule-pop-content .class-online-label.is-on{cursor:pointer;color:#1e88e5!important}::ng-deep .popover{max-width:498px;background:#ffffff;border:none;box-shadow:0 8px 12px #091e4226,0 0 1px #091e424f;border-radius:5px;color:#000}::ng-deep .popover p{color:#000}::ng-deep .popover p.sub-text-one{color:#737579}::ng-deep .popover p.unassigned_tutor{font-weight:400;font-size:14px;line-height:18px;color:#d93a3a}::ng-deep .popover .remove-icon{height:auto;width:18px;line-height:0}.btn{padding:11px 12px;gap:10px;width:102px;height:40px;border-radius:5px;cursor:pointer;background:none;color:#4b49ac;font-style:normal;font-weight:500;font-size:14px;white-space:nowrap;line-height:18px;font-family:Roboto}.btn.btn-primary{background:#4B49AC;color:#fff}.remove-lession{color:#d93a3a}\n"] }]
        }], ctorParameters: function () { return [{ type: i1.UntypedFormBuilder }, { type: i2.TranslateService }]; }, propDecorators: { debug: [{
                type: Input
            }], filterForm: [{
                type: Input
            }], timeShift: [{
                type: Input
            }], schoolYear: [{
                type: Input
            }], type: [{
                type: Input
            }], grades: [{
                type: Input
            }], lessions: [{
                type: Input
            }], timetableProblemId: [{
                type: Input
            }], majorsTranscript: [{
                type: Input
            }], timeslots: [{
                type: Input
            }], isEnableAdjustMode: [{
                type: Input
            }], showProgressLoading: [{
                type: Input
            }], onRemoveAction: [{
                type: Output
            }], onDropAcion: [{
                type: Output
            }], onCellClickAction: [{
                type: Output
            }], popUpContent: [{
                type: Input
            }], onCreateNewLession: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGltZXRhYmxlLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Byb2plY3RzL3RpbWV0YWJsZS9zcmMvbGliL3RpbWV0YWJsZS5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi9wcm9qZWN0cy90aW1ldGFibGUvc3JjL2xpYi90aW1ldGFibGUuY29tcG9uZW50Lmh0bWwiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUF3QixNQUFNLEVBQThCLE1BQU0sZUFBZSxDQUFDO0FBQ3pILE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDL0IsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDMUQsT0FBTyxLQUFLLENBQUMsTUFBTSxRQUFRLENBQUM7Ozs7Ozs7O0FBZ0M1QixNQUFNLE9BQU8sa0JBQWtCO0lBNkU5QixZQUNTLEVBQXNCLEVBQ3RCLFNBQTJCO1FBRDNCLE9BQUUsR0FBRixFQUFFLENBQW9CO1FBQ3RCLGNBQVMsR0FBVCxTQUFTLENBQWtCO1FBOUVwQyxlQUFVLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQztRQUN6QixjQUFTLEdBQUc7WUFDWCxLQUFLLEVBQUUsT0FBTztZQUNkLE1BQU0sRUFBRSxRQUFRO1lBQ2hCLEdBQUcsRUFBRSxLQUFLO1NBQ1YsQ0FBQTtRQUNELGNBQVMsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUN4Qyx3QkFBbUIsR0FBUSxJQUFJLENBQUM7UUFDZixlQUFVLEdBQUcsSUFBSSxPQUFPLEVBQVEsQ0FBQztRQUNsRCxTQUFJLEdBQUc7WUFDTixJQUFJLEVBQUUsTUFBTTtZQUNaLEdBQUcsRUFBRSxLQUFLO1NBQ1YsQ0FBQTtRQUNRLFVBQUssR0FBWSxLQUFLLENBQUM7UUFVdkIsdUJBQWtCLEdBQVksS0FBSyxDQUFDO1FBQ3BDLHdCQUFtQixHQUFZLEtBQUssQ0FBQztRQUNwQyxtQkFBYyxHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7UUFDekMsZ0JBQVcsR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDO1FBQ3RDLHNCQUFpQixHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7UUFFNUMsdUJBQWtCLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUV2RCxtQkFBYyxHQUFVLEVBQUUsQ0FBQztRQUMzQiwwQkFBcUIsR0FBUSxTQUFTLENBQUM7UUFDL0IsZUFBVSxHQUFHO1lBQ3BCLFFBQVE7WUFDUixTQUFTO1lBQ1QsV0FBVztZQUNYLFVBQVU7WUFDVixRQUFRO1lBQ1IsVUFBVTtZQUNWLFFBQVE7U0FDUixDQUFDO1FBSUYsY0FBUyxHQUFHO1lBQ1gsSUFBSSxFQUFFLElBQUk7WUFDVixhQUFhLEVBQUUsS0FBSztZQUNwQixPQUFPLEVBQUUsSUFBSTtZQUNiLE1BQU0sRUFBRSxLQUFLO1NBQ2IsQ0FBQztRQUdGLGtCQUFhLEdBQVEsRUFBRSxDQUFDO1FBQ3hCLHlCQUFvQixHQUFZLEtBQUssQ0FBQztRQUN0QyxvQkFBZSxHQUFVLEVBQUUsQ0FBQztRQUM1Qiw2QkFBd0IsR0FBVSxFQUFFLENBQUM7UUFDckMscUJBQWdCLEdBQVUsRUFBRSxDQUFDO1FBQzdCLG9CQUFlLEdBQUcsQ0FBQyxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO1FBQ3ZDLGtCQUFhLEdBQUcsSUFBSSxDQUFDO1FBQ3JCLCtCQUEwQixHQUFRLElBQUksQ0FBQztRQUN2Qyx1QkFBa0IsR0FBWSxLQUFLLENBQUM7UUFDcEMsaUJBQVksR0FBVSxFQUFFLENBQUM7UUFFekIsd0JBQW1CLEdBQUcsa0JBQWtCLENBQUMsbUJBQW1CLENBQUM7UUFLN0QsZ0JBQVcsR0FBRztZQUNiLEtBQUssRUFBRSxXQUFXO1lBQ2xCLEtBQUssRUFBRSxXQUFXO1lBQ2xCLFFBQVEsRUFBRSxTQUFTO1lBQ25CLFFBQVEsRUFBRSxVQUFVO1NBQ3BCLENBQUM7UUFNRCxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUN4QjtZQUNDLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUM7WUFDekMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLENBQUM7U0FDekMsQ0FDRCxDQUFDO1FBQ0YsSUFBSSxDQUFDLFNBQVMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDckMsQ0FBQztJQUVELFdBQVcsQ0FBQyxPQUFzQjtRQUVqQyxJQUFHLElBQUksQ0FBQyxLQUFLLEVBQUU7WUFDZCxPQUFPLENBQUMsR0FBRyxDQUFDLG9CQUFvQixFQUFFLE9BQU8sQ0FBQyxDQUFDO1NBQzNDO1FBRUQsSUFBSSxPQUFPLENBQUMsV0FBVyxDQUFDLEVBQUUsWUFBWSxFQUFFO1lBQ3ZDLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxDQUFDO1NBQzNCO1FBRUQsSUFBSSxPQUFPLENBQUMsV0FBVyxDQUFDLEVBQUUsWUFBWSxFQUFJO1lBQ3hDLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1NBQzFCO1FBRUQsSUFBSSxPQUFPLENBQUMsb0JBQW9CLENBQUMsRUFBRSxZQUFZLEVBQUk7WUFDbEQsSUFBSSxDQUFDLFNBQVMsR0FBRztnQkFDaEIsR0FBRyxJQUFJLENBQUMsU0FBUztnQkFDakIsT0FBTyxFQUFFLENBQUMsSUFBSSxDQUFDLGtCQUFrQjthQUNqQyxDQUFDO1NBQ0Y7UUFFRCxJQUFJLE9BQU8sQ0FBQyxZQUFZLENBQUMsRUFBRSxZQUFZLEVBQUc7WUFDekMsSUFBSSxDQUFDLGlCQUFpQixFQUFFLENBQUM7U0FDekI7UUFFRCxJQUFJLE9BQU8sQ0FBQyxVQUFVLENBQUMsRUFBRSxZQUFZLEVBQUU7WUFDdEMsSUFBSSxDQUFDLGtCQUFrQixFQUFFLENBQUM7U0FDMUI7SUFDRixDQUFDO0lBRUQsaUJBQWlCO1FBQ2hCLElBQUcsQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUU7WUFDdEMsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO1NBQ3RCO0lBQ0YsQ0FBQztJQUVELGlCQUFpQjtRQUNoQixNQUFNLFdBQVcsR0FBcUIsSUFBSSxDQUFDLFNBQVMsQ0FBQztRQUNyRCxJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEdBQUcsRUFBRSxFQUFFO1lBQy9CLE1BQU0sVUFBVSxHQUFHLFdBQVcsQ0FBQyxNQUFNLENBQ3BDLENBQUMsSUFBUyxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsU0FBUyxLQUFLLEdBQUcsSUFBSSxJQUFJLENBQUMsU0FBUyxLQUFLLElBQUksQ0FBQyxTQUFTLENBQzFFLENBQUM7WUFDRixJQUFJLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxHQUFHO2dCQUN6QixLQUFLLEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsQ0FBQyxPQUFPLENBQUMsQ0FBQzthQUN2QyxDQUFDO1lBQ0YsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQ3ZELElBQUksQ0FBQyxZQUFZLEdBQUcsQ0FBQyxHQUFHLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO1FBQ25ELENBQUMsQ0FBQyxDQUFDO0lBQ0osQ0FBQztJQUVELGtCQUFrQixDQUFDLFFBQWU7UUFDakMsT0FBTyxDQUFDLENBQUMsS0FBSyxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQU0sRUFBRSxFQUFFLEdBQUcsT0FBTyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsS0FBSyxJQUFJLEVBQUUsQ0FBQztJQUN4RSxDQUFDO0lBRUQsbUJBQW1CO1FBQ2xCLElBQUksQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsR0FBVyxFQUFFLEVBQUU7WUFDdkMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsR0FBRztnQkFDekIsS0FBSyxFQUFFLEVBQUU7YUFDVCxDQUFDO1FBQ0gsQ0FBQyxDQUFDLENBQUM7SUFDSixDQUFDO0lBRUQsa0JBQWtCO1FBQ2pCLElBQUksQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsR0FBRyxFQUFFLEVBQUU7WUFDL0IsTUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQ3RDLENBQUMsSUFBUyxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsU0FBUyxLQUFLLEdBQUcsQ0FDckMsQ0FBQztZQUNGLElBQUksQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLEdBQUc7Z0JBQ3pCLEtBQUssRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDO2FBQ3ZDLENBQUM7UUFDSCxDQUFDLENBQUMsQ0FBQztJQUNKLENBQUM7SUFFRCxnQkFBZ0IsQ0FBQyxHQUFXLEVBQUUsS0FBYSxFQUFFLFNBQWlCO1FBQzdELE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUMxQyxDQUFDLElBQVMsRUFBRSxFQUFFO1lBQ2IsTUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssS0FBSyxLQUFLLElBQUksSUFBSSxFQUFFLFNBQVMsS0FBSyxTQUFTLENBQUM7WUFDcEUsT0FBTyxLQUFLLENBQUM7UUFDZCxDQUFDLENBQ0QsQ0FBQztJQUNILENBQUM7SUFFRCxjQUFjO1FBQ2IsSUFBSSxDQUFDLG1CQUFtQixFQUFFLENBQUM7SUFDNUIsQ0FBQztJQUdELGdCQUFnQixDQUFDLEtBQVU7UUFDMUIsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLEtBQUssQ0FBQyxJQUFJLEVBQUUsRUFBRSxRQUFRLENBQUMsQ0FBQTtJQUMvQyxDQUFDO0lBRUQsa0JBQWtCO1FBQ2pCLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsSUFBUyxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxLQUFLLElBQUksQ0FBQyxVQUFVLENBQUMsV0FBVyxDQUFDLENBQUMsRUFBRSxLQUFLLENBQUM7SUFDOUYsQ0FBQztJQUVELE1BQU0sQ0FBQyxLQUFtQixFQUFFLEdBQVcsRUFBRSxPQUFlLEVBQUUsU0FBaUI7UUFFMUUsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFFNUMsTUFBTSxXQUFXLEdBQUc7WUFDbkIsSUFBSSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFLGlCQUFpQixFQUFFLENBQUMsQ0FBQztZQUN4QyxZQUFZLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUseUJBQXlCLEVBQUUsQ0FBQyxDQUFDO1lBQ3hELFVBQVUsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLEtBQUssRUFBRSx1QkFBdUIsRUFBRSxDQUFDLENBQUM7WUFDcEQsVUFBVSxFQUFFLFFBQVEsQ0FBQyxFQUFFO1lBQ3ZCLGtCQUFrQixFQUFFLElBQUksQ0FBQyxrQkFBa0I7WUFDM0MsT0FBTyxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFLG9CQUFvQixFQUFFLElBQUksQ0FBQztZQUNqRCxPQUFPLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsb0JBQW9CLEVBQUUsSUFBSSxDQUFDO1lBQ2pELE9BQU8sRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLEtBQUssRUFBRSxvQkFBb0IsRUFBRSxJQUFJLENBQUM7U0FDakQsQ0FBQztRQUVGLE1BQU0sT0FBTyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUM7UUFFOUIsSUFBSSxjQUFjLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxFQUFFLE9BQU8sRUFBRSxTQUFTLENBQUMsRUFBRSxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFFdEYsSUFBSSxjQUFjLEVBQUU7WUFFbkIsY0FBYyxHQUFHO2dCQUNoQixJQUFJLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxjQUFjLEVBQUUsWUFBWSxFQUFFLENBQUMsQ0FBQztnQkFDNUMsWUFBWSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsY0FBYyxFQUFFLG9CQUFvQixFQUFFLENBQUMsQ0FBQztnQkFDNUQsVUFBVSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsY0FBYyxFQUFFLGtCQUFrQixFQUFFLENBQUMsQ0FBQztnQkFDeEQsVUFBVSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFLDBCQUEwQixFQUFFLENBQUMsQ0FBQztnQkFDdkQsa0JBQWtCLEVBQUUsSUFBSSxDQUFDLGtCQUFrQjtnQkFDM0MsT0FBTyxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsY0FBYyxFQUFFLGVBQWUsRUFBRSxJQUFJLENBQUM7Z0JBQ3JELE9BQU8sRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLGNBQWMsRUFBRSxlQUFlLEVBQUUsSUFBSSxDQUFDO2dCQUNyRCxPQUFPLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxjQUFjLEVBQUUsZUFBZSxFQUFFLElBQUksQ0FBQzthQUNyRCxDQUFDO1lBRUYsT0FBTyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQztTQUM3QjtRQUVELElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBRWhDLENBQUM7SUFFRCxpQkFBaUIsQ0FBQyxNQUFXO1FBRTVCLElBQUksQ0FBQyxrQkFBa0IsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQztRQUVoRCxJQUFJLENBQUMsU0FBUyxHQUFHO1lBQ2hCLEdBQUcsSUFBSSxDQUFDLFNBQVM7WUFDakIsT0FBTyxFQUFFLENBQUMsSUFBSSxDQUFDLGtCQUFrQjtTQUNqQyxDQUFDO0lBRUgsQ0FBQztJQUVELE9BQU8sQ0FBQyxHQUFXLEVBQUUsS0FBYTtRQUNqQyxNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FDL0IsQ0FBQyxJQUFTLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxTQUFTLEtBQUssR0FBRyxJQUFJLElBQUksQ0FBQyxTQUFTLEtBQUssSUFBSSxDQUFDLFNBQVMsSUFBSSxJQUFJLENBQUMsS0FBSyxLQUFLLEtBQUssQ0FDbEcsQ0FBQztRQUNGLE9BQU8sSUFBSSxDQUFDO0lBQ2IsQ0FBQztJQUVELGNBQWMsQ0FBQyxHQUFXLEVBQUUsS0FBYTtRQUN4QyxPQUFPLElBQUksQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FDMUMsQ0FBQyxJQUFvQixFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsS0FBSyxLQUFLLEtBQUssQ0FDOUMsQ0FBQztJQUNILENBQUM7SUFFRCxXQUFXLENBQUMsQ0FBTSxFQUFFLEdBQVcsRUFBRSxPQUFlLEVBQUUsU0FBaUI7UUFFbEUsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQztRQUM3QyxJQUFJLENBQUMscUJBQXFCLEdBQUcsSUFBSSxDQUFDO1FBQ2xDLElBQUksQ0FBQyxJQUFJLENBQUMsa0JBQWtCLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU87WUFBRSxPQUFPO1FBQ2pFLElBQUksQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixDQUFDLEdBQUcsRUFBRSxPQUFPLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDckUsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDO1FBRVQsSUFBSSxDQUFDLElBQUksQ0FBQyxjQUFjLEVBQUUsTUFBTSxFQUFFO1lBQ2pDLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUM7WUFDMUIsSUFBSSxDQUFDLGdCQUFnQixHQUFHLENBQUMsQ0FBQztZQUMxQixJQUFJLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQztTQUNqRDthQUFNO1lBQ04sSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztTQUMzQjtJQUNGLENBQUM7SUFFRCx1QkFBdUIsQ0FBQyxNQUFXO1FBQ2xDLElBQUksQ0FBQyxxQkFBcUIsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBUyxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxLQUFLLE1BQU0sQ0FBQyxDQUFDO0lBQzlGLENBQUM7SUFFRCxRQUFRO1FBQ1AsT0FBTztZQUNOLE1BQU0sRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxxQkFBcUIsRUFBRSwyQkFBMkIsRUFBRSxDQUFDLENBQUM7WUFDekUsTUFBTSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLHFCQUFxQixFQUFFLDJCQUEyQixFQUFFLENBQUMsQ0FBQztTQUN6RSxDQUFBO0lBQ0YsQ0FBQztJQUVELFFBQVE7UUFDUCxPQUFPO1lBQ04sTUFBTSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLHFCQUFxQixFQUFFLDJCQUEyQixFQUFFLENBQUMsQ0FBQztZQUN6RSxNQUFNLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMscUJBQXFCLEVBQUUsMkJBQTJCLEVBQUUsQ0FBQyxDQUFDO1NBQ3pFLENBQUE7SUFDRixDQUFDO0lBRUQsUUFBUTtRQUNQLE9BQU87WUFDTixNQUFNLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMscUJBQXFCLEVBQUUseUJBQXlCLEVBQUUsQ0FBQyxDQUFDO1lBQ3ZFLE1BQU0sRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxxQkFBcUIsRUFBRSwyQkFBMkIsRUFBRSxDQUFDLENBQUM7WUFDekUsV0FBVyxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLHFCQUFxQixFQUFFLDJCQUEyQixFQUFFLENBQUMsQ0FBQztTQUM5RSxDQUFBO0lBQ0YsQ0FBQztJQUVELGdCQUFnQjtRQUVmLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUs7WUFBRSxPQUFPO1FBRTdCLE1BQU0sT0FBTyxHQUFHO1lBQ2YsWUFBWSxFQUFFLElBQUksQ0FBQyxVQUFVO1lBQzdCLFVBQVUsRUFBRSxJQUFJLENBQUMsVUFBVSxDQUFDLFFBQVE7WUFDcEMsWUFBWSxFQUFFLElBQUksQ0FBQyxVQUFVLEVBQUUsRUFBRTtZQUNqQyxvQkFBb0IsRUFBRSxJQUFJLENBQUMsa0JBQWtCO1lBQzdDLE9BQU8sRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFO1lBQ3hCLE9BQU8sRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFO1lBQ3hCLE9BQU8sRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFO1NBQ3hCLENBQUE7UUFFRCxJQUFJLENBQUMsa0JBQWtCLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBRXZDLENBQUM7SUFFRCxJQUFJLGVBQWU7UUFDbEIsT0FBTyxJQUFJLENBQUMscUJBQXFCLElBQUksSUFBSSxDQUFDLHFCQUFxQixFQUFFLGVBQWUsRUFBRSxTQUFTLENBQUM7SUFDN0YsQ0FBQztJQUVELElBQUksaUJBQWlCO1FBQ3BCLE9BQU8sSUFBSSxDQUFDLHFCQUFxQixJQUFJLENBQUMsSUFBSSxDQUFDLHFCQUFxQixFQUFFLGVBQWUsRUFBRSxTQUFTLENBQUM7SUFDOUYsQ0FBQztJQUVELFNBQVM7UUFDUixJQUFJLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDL0IsQ0FBQztJQUVELHFCQUFxQjtRQUNwQixNQUFNLGFBQWEsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzdDLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFBO0lBQ3hDLENBQUM7SUFFRCxXQUFXO1FBQ1YsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsQ0FBQztRQUN2QixJQUFJLENBQUMsVUFBVSxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQzNCLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUN2QixDQUFDOzsrR0ExVVcsa0JBQWtCO21HQUFsQixrQkFBa0Isc21CQ25DL0IsK2lOQW9KQTsyRkRqSGEsa0JBQWtCO2tCQUw5QixTQUFTOytCQUNDLG9CQUFvQjt3SUFrQnJCLEtBQUs7c0JBQWIsS0FBSztnQkFDRyxVQUFVO3NCQUFsQixLQUFLO2dCQUNHLFNBQVM7c0JBQWpCLEtBQUs7Z0JBQ0csVUFBVTtzQkFBbEIsS0FBSztnQkFDRyxJQUFJO3NCQUFaLEtBQUs7Z0JBQ0csTUFBTTtzQkFBZCxLQUFLO2dCQUNHLFFBQVE7c0JBQWhCLEtBQUs7Z0JBQ0csa0JBQWtCO3NCQUExQixLQUFLO2dCQUNHLGdCQUFnQjtzQkFBeEIsS0FBSztnQkFDRyxTQUFTO3NCQUFqQixLQUFLO2dCQUNHLGtCQUFrQjtzQkFBMUIsS0FBSztnQkFDRyxtQkFBbUI7c0JBQTNCLEtBQUs7Z0JBQ0ksY0FBYztzQkFBdkIsTUFBTTtnQkFDRyxXQUFXO3NCQUFwQixNQUFNO2dCQUNHLGlCQUFpQjtzQkFBMUIsTUFBTTtnQkFDRSxZQUFZO3NCQUFwQixLQUFLO2dCQUNJLGtCQUFrQjtzQkFBM0IsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgRXZlbnRFbWl0dGVyLCBJbnB1dCwgT25DaGFuZ2VzLCBPbkRlc3Ryb3ksIE91dHB1dCwgU2ltcGxlQ2hhbmdlcywgVGVtcGxhdGVSZWYgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IFRpbWV0YWJsZUNvbnN0YW50cyB9IGZyb20gJy4vdGltZXRhYmxlLmNvbnN0YW50JztcbmltcG9ydCAqIGFzIF8gZnJvbSBcImxvZGFzaFwiO1xuaW1wb3J0IHsgRG5kRHJvcEV2ZW50IH0gZnJvbSAnbmd4LWRyYWctZHJvcCc7XG5pbXBvcnQgeyBVbnR5cGVkRm9ybUJ1aWxkZXIsIFVudHlwZWRGb3JtR3JvdXAgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQgeyBUcmFuc2xhdGVTZXJ2aWNlIH0gZnJvbSAnQG5neC10cmFuc2xhdGUvY29yZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVRpbWV0YWJsZVNsb3Qge1xuXHRpZDogc3RyaW5nO1xuXHRlbmFibGVkOiBib29sZWFuLFxuXHRkYXlPZldlZWs6IHN0cmluZztcblx0dGltZXNsb3Q6IGFueSxcblx0dGltZVNoaWZ0OiBzdHJpbmc7XG5cdHN0YXJ0VGltZTogbnVtYmVyO1xuXHRlbmRUaW1lOiBudW1iZXI7XG5cdG9yZGVyOiBudW1iZXI7XG5cdGF2YWlsYWJsZTogYm9vbGVhbjtcblx0ZGV0YWlscz86IElBdmFpbGFiaWxpdHkgfCBudWxsXG59XG5leHBvcnQgaW50ZXJmYWNlIElBdmFpbGFiaWxpdHkge1xuXHRpZD86IG51bWJlciB8IG51bGw7XG5cdHRpbWVzbG90SWQ6IHN0cmluZztcblx0c2Nob29sWWVhcjogbnVtYmVyO1xuXHR0aW1lU2hpZnQ/OiBzdHJpbmc7XG5cdHNlbWVzdGVyOiBzdHJpbmc7XG5cdGF2YWlsYWJsZTogYm9vbGVhbjtcblx0Z3JhZGVDb2RlOiBzdHJpbmc7XG5cdHJlYXNvbk9mVW5hdmFpbGFiaWxpdHk6IGFueTtcbn1cbkBDb21wb25lbnQoe1xuXHRzZWxlY3RvcjogJ3RhZGEtbmd4LXRpbWV0YWJsZScsXG5cdHRlbXBsYXRlVXJsOiAndGltZXRhYmxlLmNvbXBvbmVudC5odG1sJyxcblx0c3R5bGVVcmxzOiBbXCJ0aW1ldGFibGUuY29tcG9uZW50LnNjc3NcIl1cbn0pXG5leHBvcnQgY2xhc3MgVGltZXRhYmxlQ29tcG9uZW50IGltcGxlbWVudHMgT25EZXN0cm95LCBPbkNoYW5nZXMge1xuXHRvYmplY3RLZXlzID0gT2JqZWN0LmtleXM7XG5cdFNFTUVTVEVSUyA9IHtcblx0XHRGSVJTVDogJ0ZJUlNUJyxcblx0XHRTRUNPTkQ6ICdTRUNPTkQnLFxuXHRcdEFMTDogJ0FMTCdcblx0fVxuXHRzZW1lc3RlcnMgPSBPYmplY3Qua2V5cyh0aGlzLlNFTUVTVEVSUyk7XG5cdHNvbHZlclN0YXR1c01lc3NhZ2U6IGFueSA9IG51bGw7XG5cdHByaXZhdGUgcmVhZG9ubHkgZGVzdHJveWVkJCA9IG5ldyBTdWJqZWN0PHZvaWQ+KCk7XG5cdE1PREUgPSB7XG5cdFx0RURJVDogJ2VkaXQnLFxuXHRcdE5FVzogJ25ldydcblx0fVxuXHRASW5wdXQoKSBkZWJ1ZzogYm9vbGVhbiA9IGZhbHNlO1xuXHRASW5wdXQoKSBmaWx0ZXJGb3JtOiBhbnk7XG5cdEBJbnB1dCgpIHRpbWVTaGlmdDogYW55O1xuXHRASW5wdXQoKSBzY2hvb2xZZWFyOiBhbnk7XG5cdEBJbnB1dCgpIHR5cGUhOiBzdHJpbmc7XG5cdEBJbnB1dCgpIGdyYWRlcyE6IGFueVtdO1xuXHRASW5wdXQoKSBsZXNzaW9ucyE6IGFueVtdO1xuXHRASW5wdXQoKSB0aW1ldGFibGVQcm9ibGVtSWQhOiBhbnk7XG5cdEBJbnB1dCgpIG1ham9yc1RyYW5zY3JpcHQhOiBhbnlbXTtcblx0QElucHV0KCkgdGltZXNsb3RzITogYW55W107XG5cdEBJbnB1dCgpIGlzRW5hYmxlQWRqdXN0TW9kZTogYm9vbGVhbiA9IGZhbHNlO1xuXHRASW5wdXQoKSBzaG93UHJvZ3Jlc3NMb2FkaW5nOiBib29sZWFuID0gZmFsc2U7XG5cdEBPdXRwdXQoKSBvblJlbW92ZUFjdGlvbiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXHRAT3V0cHV0KCkgb25Ecm9wQWNpb24gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblx0QE91dHB1dCgpIG9uQ2VsbENsaWNrQWN0aW9uID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cdEBJbnB1dCgpIHBvcFVwQ29udGVudCE6IFRlbXBsYXRlUmVmPGFueT47XG5cdEBPdXRwdXQoKSBvbkNyZWF0ZU5ld0xlc3Npb24gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuXHRhY3RpdmVMZXNzaW9uczogYW55W10gPSBbXTtcblx0YWN0aXZlVGVhY2hNYW5hZ2VtZW50OiBhbnkgPSB1bmRlZmluZWQ7XG5cdHByaXZhdGUgZGF5c09mV2VlayA9IFtcblx0XHRcIk1PTkRBWVwiLFxuXHRcdFwiVFVFU0RBWVwiLFxuXHRcdFwiV0VETkVTREFZXCIsXG5cdFx0XCJUSFVSU0RBWVwiLFxuXHRcdFwiRlJJREFZXCIsXG5cdFx0XCJTQVRVUkRBWVwiLFxuXHRcdFwiU1VOREFZXCIsXG5cdF07XG5cblx0bW9kZTogYW55O1xuXG5cdGRyYWdnYWJsZSA9IHtcblx0XHRkYXRhOiBudWxsLFxuXHRcdGVmZmVjdEFsbG93ZWQ6IFwiYWxsXCIsXG5cdFx0ZGlzYWJsZTogdHJ1ZSxcblx0XHRoYW5kbGU6IGZhbHNlXG5cdH07XG5cblx0Zm9ybSE6IFVudHlwZWRGb3JtR3JvdXA7XG5cdHRpbWVUYWJsZURhdGE6IGFueSA9IHt9O1xuXHRpc0F1dG9VcGRhdGVDbGFzc0lkczogYm9vbGVhbiA9IGZhbHNlO1xuXHRzZWxlY3RlZENsYXNzZXM6IGFueVtdID0gW107XG5cdGNsYXNzTGlzdFNlbGVjdGVkRGVmYXVsdDogYW55W10gPSBbXTtcblx0dGVhY2hNYW5hZ2VtZW50czogYW55W10gPSBbXTtcblx0ZGF5TGVzc2lvblNsb3RzID0gWy4uLkFycmF5KDUpLmtleXMoKV07XG5cdENBTExCQUNLX1RJTUUgPSA1MDAwO1xuXHRjaGVja2luZ0dlbmVyYXRlUHJvZ3Jlc3NlcjogYW55ID0gbnVsbDtcblx0aXNEaXNhYmxlZFBsYW5uaW5nOiBib29sZWFuID0gZmFsc2U7XG5cdHNsb3ROdW1PZkRheTogYW55W10gPSBbXTtcblxuXHRUSU1FVEFCTEVfRURJVF9NT0RFID0gVGltZXRhYmxlQ29uc3RhbnRzLlRJTUVUQUJMRV9FRElUX01PREU7XG5cblx0YWN0aXZlU2xvdDogYW55O1xuXHRhY3RpdmVGb3JtRGlhbG9nOiBhbnk7XG5cblx0Rk9STV9GSUVMRFMgPSB7XG5cdFx0TUFKT1I6ICdtYWpvckNvZGUnLFxuXHRcdFRVVE9SOiAndHV0b3JVdWlkJyxcblx0XHRDTEFTU19JRDogJ2NsYXNzSWQnLFxuXHRcdFNFTUVTVEVSOiAnc2VtZXN0ZXInXG5cdH07XG5cblx0Y29uc3RydWN0b3IoXG5cdFx0cHJpdmF0ZSBmYjogVW50eXBlZEZvcm1CdWlsZGVyLFxuXHRcdHByaXZhdGUgdHJhbnNsYXRlOiBUcmFuc2xhdGVTZXJ2aWNlXG5cdCkge1xuXHRcdHRoaXMuZm9ybSA9IHRoaXMuZmIuZ3JvdXAoXG5cdFx0XHR7XG5cdFx0XHRcdFt0aGlzLkZPUk1fRklFTERTLk1BSk9SXTogW3sgdmFsdWU6IC0xIH1dLFxuXHRcdFx0XHRbdGhpcy5GT1JNX0ZJRUxEUy5UVVRPUl06IFt7IHZhbHVlOiAnJyB9XVxuXHRcdFx0fVxuXHRcdCk7XG5cdFx0dGhpcy50cmFuc2xhdGUuc2V0RGVmYXVsdExhbmcoJ3ZuJyk7XG5cdH1cblxuXHRuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XG5cblx0XHRpZih0aGlzLmRlYnVnKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcIl9fVElNRVRBQkxFX1BST1BTOlwiLCBjaGFuZ2VzKTtcblx0XHR9XG5cblx0XHRpZiAoY2hhbmdlc1sndGltZVNoaWZ0J10/LmN1cnJlbnRWYWx1ZSkge1xuXHRcdFx0dGhpcy5idWlsZFRpbWVUYWJsZUJhc2ljKCk7XG5cdFx0fVxuXHRcdFxuXHRcdGlmIChjaGFuZ2VzWyd0aW1lc2xvdHMnXT8uY3VycmVudFZhbHVlICApIHtcblx0XHRcdFx0dGhpcy5pbml0VGltZXRhYmxlU2xvdCgpO1xuXHRcdH1cblxuXHRcdGlmIChjaGFuZ2VzWydpc0VuYWJsZUFkanVzdE1vZGUnXT8uY3VycmVudFZhbHVlICApIHtcblx0XHRcdHRoaXMuZHJhZ2dhYmxlID0ge1xuXHRcdFx0XHQuLi50aGlzLmRyYWdnYWJsZSxcblx0XHRcdFx0ZGlzYWJsZTogIXRoaXMuaXNFbmFibGVBZGp1c3RNb2RlXG5cdFx0XHR9O1xuXHRcdH1cblxuXHRcdGlmIChjaGFuZ2VzWydmaWx0ZXJGb3JtJ10/LmN1cnJlbnRWYWx1ZSkgIHtcblx0XHRcdHRoaXMuZmlsdGVyRm9ybUNoYW5nZXMoKTtcblx0XHR9XG5cblx0XHRpZiAoY2hhbmdlc1snbGVzc2lvbnMnXT8uY3VycmVudFZhbHVlKSB7XG5cdFx0XHR0aGlzLm1hcHBpbmdEYXRhVG9UYWJsZSgpO1xuXHRcdH1cblx0fVxuXG5cdGZpbHRlckZvcm1DaGFuZ2VzKCkge1xuXHRcdGlmKCF0aGlzLmZpbHRlckZvcm0/LmNsYXNzSWRzPy5sZW5ndGgpIHtcblx0XHRcdHRoaXMucmVzZXRUaW1lVGFibGUoKTtcblx0XHR9XG5cdH1cblxuXHRpbml0VGltZXRhYmxlU2xvdCgpIHtcblx0XHRjb25zdCBhbGx0aW1lc2xvdDogSVRpbWV0YWJsZVNsb3RbXSA9IHRoaXMudGltZXNsb3RzO1xuXHRcdHRoaXMuZGF5c09mV2Vlay5mb3JFYWNoKChkYXkpID0+IHtcblx0XHRcdGNvbnN0IHNsb3RzT2ZEYXkgPSBhbGx0aW1lc2xvdC5maWx0ZXIoXG5cdFx0XHRcdChzbG90OiBhbnkpID0+IHNsb3QuZGF5T2ZXZWVrID09PSBkYXkgJiYgc2xvdC50aW1lU2hpZnQgPT09IHRoaXMudGltZVNoaWZ0XG5cdFx0XHQpO1xuXHRcdFx0dGhpcy50aW1lVGFibGVEYXRhW2RheV0gPSB7XG5cdFx0XHRcdGl0ZW1zOiBfLm9yZGVyQnkoc2xvdHNPZkRheSwgW1wib3JkZXJcIl0pLFxuXHRcdFx0fTtcblx0XHRcdGNvbnN0IG1heExlc3Npb24gPSB0aGlzLmdldE1heGxlc3Npb25PcmRlcihzbG90c09mRGF5KTtcblx0XHRcdHRoaXMuc2xvdE51bU9mRGF5ID0gWy4uLkFycmF5KG1heExlc3Npb24pLmtleXMoKV07XG5cdFx0fSk7XG5cdH1cblxuXHRnZXRNYXhsZXNzaW9uT3JkZXIodGltZVNsb3Q6IGFueVtdKSB7XG5cdFx0cmV0dXJuIF8ubWF4QnkodGltZVNsb3QsIChvOiBhbnkpID0+IHsgcmV0dXJuIG8ub3JkZXI7IH0pPy5vcmRlciB8fCAxMDtcblx0fVxuXG5cdGJ1aWxkVGltZVRhYmxlQmFzaWMoKSB7XG5cdFx0dGhpcy5kYXlzT2ZXZWVrLmZvckVhY2goKGRheTogc3RyaW5nKSA9PiB7XG5cdFx0XHR0aGlzLnRpbWVUYWJsZURhdGFbZGF5XSA9IHtcblx0XHRcdFx0aXRlbXM6IFtdLFxuXHRcdFx0fTtcblx0XHR9KTtcblx0fVxuXG5cdG1hcHBpbmdEYXRhVG9UYWJsZSgpIHtcblx0XHR0aGlzLmRheXNPZldlZWsuZm9yRWFjaCgoZGF5KSA9PiB7XG5cdFx0XHRjb25zdCBzbG90c09mRGF5ID0gdGhpcy5sZXNzaW9ucy5maWx0ZXIoXG5cdFx0XHRcdChzbG90OiBhbnkpID0+IHNsb3QuZGF5T2ZXZWVrID09PSBkYXlcblx0XHRcdCk7XG5cdFx0XHR0aGlzLnRpbWVUYWJsZURhdGFbZGF5XSA9IHtcblx0XHRcdFx0aXRlbXM6IF8ub3JkZXJCeShzbG90c09mRGF5LCBbXCJvcmRlclwiXSksXG5cdFx0XHR9O1xuXHRcdH0pO1xuXHR9XG5cblx0Z2V0TGVzc29uQnlPcmRlcihkYXk6IHN0cmluZywgaW5kZXg6IG51bWJlciwgdGltZVNoaWZ0OiBzdHJpbmcpIHtcblx0XHRyZXR1cm4gdGhpcy50aW1lVGFibGVEYXRhW2RheV0uaXRlbXMuZmlsdGVyKFxuXHRcdFx0KGl0ZW06IGFueSkgPT4ge1xuXHRcdFx0XHRjb25zdCBmb3VuZCA9IGl0ZW0ub3JkZXIgPT09IGluZGV4ICYmIGl0ZW0/LnRpbWVTaGlmdCA9PT0gdGltZVNoaWZ0O1xuXHRcdFx0XHRyZXR1cm4gZm91bmQ7XG5cdFx0XHR9XG5cdFx0KTtcblx0fVxuXG5cdHJlc2V0VGltZVRhYmxlKCkge1xuXHRcdHRoaXMuYnVpbGRUaW1lVGFibGVCYXNpYygpO1xuXHR9XG5cblxuXHRvbkNsaWNrVHV0b3JOYW1lKHR1dG9yOiBhbnkpIHtcblx0XHR3aW5kb3cub3BlbihgL3R1dG9ycy8ke3R1dG9yLnV1aWR9YCwgJ19ibGFuaycpXG5cdH1cblxuXHRnZXRBY3RpdmVHcmFkZU5hbWUoKSB7XG5cdFx0cmV0dXJuIF8uZmluZCh0aGlzLmdyYWRlcywgKGl0ZW06IGFueSkgPT4gaXRlbS5jb2RlID09PSB0aGlzLmZpbHRlckZvcm1bJ2dyYWRlQ29kZSddKT8udGl0bGU7XG5cdH1cblxuXHRvbkRyb3AoZXZlbnQ6IERuZERyb3BFdmVudCwgZGF5OiBzdHJpbmcsIHNsb3ROdW06IG51bWJlciwgdGltZVNoaWZ0OiBzdHJpbmcpIHtcblxuXHRcdGNvbnN0IGRyb3BTbG90ID0gdGhpcy5nZXRTbG90KGRheSwgc2xvdE51bSk7XG5cblx0XHRjb25zdCBkcm9wTGVzc2lvbiA9IHtcblx0XHRcdFwiaWRcIjogXy5nZXQoZXZlbnQsIFwiZGF0YS5kZXRhaWxzLmlkXCIsIDApLFxuXHRcdFx0XCJzY2hvb2xZZWFyXCI6IF8uZ2V0KGV2ZW50LCBcImRhdGEuZGV0YWlscy5zY2hvb2xZZWFyXCIsIDApLFxuXHRcdFx0XCJzZW1lc3RlclwiOiBfLmdldChldmVudCwgXCJkYXRhLmRldGFpbHMuc2VtZXN0ZXJcIiwgMCksXG5cdFx0XHR0aW1lc2xvdElkOiBkcm9wU2xvdC5pZCxcblx0XHRcdHRpbWV0YWJsZVByb2JsZW1JZDogdGhpcy50aW1ldGFibGVQcm9ibGVtSWQsXG5cdFx0XHRcInR1dG9yXCI6IF8uZ2V0KGV2ZW50LCBcImRhdGEuZGV0YWlscy50dXRvclwiLCBudWxsKSxcblx0XHRcdFwibWFqb3JcIjogXy5nZXQoZXZlbnQsIFwiZGF0YS5kZXRhaWxzLm1ham9yXCIsIG51bGwpLFxuXHRcdFx0XCJjbGF6elwiOiBfLmdldChldmVudCwgXCJkYXRhLmRldGFpbHMuY2xhenpcIiwgbnVsbCksXG5cdFx0fTtcblxuXHRcdGNvbnN0IHBheWxvYWQgPSBbZHJvcExlc3Npb25dO1xuXG5cdFx0bGV0IGN1cnJlbnRMZXNzaW9uID0gXy5nZXQodGhpcy5nZXRMZXNzb25CeU9yZGVyKGRheSwgc2xvdE51bSwgdGltZVNoaWZ0KSwgXCIwXCIsIG51bGwpO1xuXG5cdFx0aWYgKGN1cnJlbnRMZXNzaW9uKSB7XG5cblx0XHRcdGN1cnJlbnRMZXNzaW9uID0ge1xuXHRcdFx0XHRcImlkXCI6IF8uZ2V0KGN1cnJlbnRMZXNzaW9uLCBcImRldGFpbHMuaWRcIiwgMCksXG5cdFx0XHRcdFwic2Nob29sWWVhclwiOiBfLmdldChjdXJyZW50TGVzc2lvbiwgXCJkZXRhaWxzLnNjaG9vbFllYXJcIiwgMCksXG5cdFx0XHRcdFwic2VtZXN0ZXJcIjogXy5nZXQoY3VycmVudExlc3Npb24sIFwiZGV0YWlscy5zZW1lc3RlclwiLCAwKSxcblx0XHRcdFx0dGltZXNsb3RJZDogXy5nZXQoZXZlbnQsIFwiZGF0YS5kZXRhaWxzLnRpbWVzbG90LmlkXCIsIDApLFxuXHRcdFx0XHR0aW1ldGFibGVQcm9ibGVtSWQ6IHRoaXMudGltZXRhYmxlUHJvYmxlbUlkLFxuXHRcdFx0XHRcInR1dG9yXCI6IF8uZ2V0KGN1cnJlbnRMZXNzaW9uLCBcImRldGFpbHMudHV0b3JcIiwgbnVsbCksXG5cdFx0XHRcdFwibWFqb3JcIjogXy5nZXQoY3VycmVudExlc3Npb24sIFwiZGV0YWlscy5tYWpvclwiLCBudWxsKSxcblx0XHRcdFx0XCJjbGF6elwiOiBfLmdldChjdXJyZW50TGVzc2lvbiwgXCJkZXRhaWxzLmNsYXp6XCIsIG51bGwpLFxuXHRcdFx0fTtcblxuXHRcdFx0cGF5bG9hZC5wdXNoKGN1cnJlbnRMZXNzaW9uKTtcblx0XHR9XG5cblx0XHR0aGlzLm9uRHJvcEFjaW9uLmVtaXQocGF5bG9hZCk7XG5cblx0fVxuXG5cdGNoYW5nZU9uT2ZmU3dpdGNoKCRldmVudDogYW55KSB7XG5cblx0XHR0aGlzLmlzRW5hYmxlQWRqdXN0TW9kZSA9ICRldmVudC50YXJnZXQuY2hlY2tlZDtcblxuXHRcdHRoaXMuZHJhZ2dhYmxlID0ge1xuXHRcdFx0Li4udGhpcy5kcmFnZ2FibGUsXG5cdFx0XHRkaXNhYmxlOiAhdGhpcy5pc0VuYWJsZUFkanVzdE1vZGVcblx0XHR9O1xuXG5cdH1cblxuXHRnZXRTbG90KGRheTogc3RyaW5nLCBvcmRlcjogbnVtYmVyKSB7XG5cdFx0Y29uc3Qgc2xvdCA9IHRoaXMudGltZXNsb3RzLmZpbmQoXG5cdFx0XHQoc2xvdDogYW55KSA9PiBzbG90LmRheU9mV2VlayA9PT0gZGF5ICYmIHNsb3QudGltZVNoaWZ0ID09PSB0aGlzLnRpbWVTaGlmdCAmJiBzbG90Lm9yZGVyID09PSBvcmRlclxuXHRcdCk7XG5cdFx0cmV0dXJuIHNsb3Q7XG5cdH1cblxuXHRnZXRTbG90QnlPcmRlcihkYXk6IHN0cmluZywgaW5kZXg6IG51bWJlcikge1xuXHRcdHJldHVybiB0aGlzLnRpbWVUYWJsZURhdGFbZGF5XS5pdGVtcy5maWx0ZXIoXG5cdFx0XHQoaXRlbTogSVRpbWV0YWJsZVNsb3QpID0+IGl0ZW0ub3JkZXIgPT09IGluZGV4XG5cdFx0KTtcblx0fVxuXG5cdG9uQ2VsbENsaWNrKHA6IGFueSwgZGF5OiBzdHJpbmcsIHNsb3ROdW06IG51bWJlciwgdGltZVNoaWZ0OiBzdHJpbmcpIHtcblxuXHRcdHRoaXMuYWN0aXZlU2xvdCA9IHRoaXMuZ2V0U2xvdChkYXksIHNsb3ROdW0pO1xuXHRcdHRoaXMuYWN0aXZlVGVhY2hNYW5hZ2VtZW50ID0gbnVsbDtcblx0XHRpZiAoIXRoaXMuaXNFbmFibGVBZGp1c3RNb2RlIHx8ICF0aGlzLmFjdGl2ZVNsb3QuZW5hYmxlZCkgcmV0dXJuO1xuXHRcdHRoaXMuYWN0aXZlTGVzc2lvbnMgPSB0aGlzLmdldExlc3NvbkJ5T3JkZXIoZGF5LCBzbG90TnVtLCB0aW1lU2hpZnQpO1xuXHRcdHAub3BlbigpO1xuXG5cdFx0aWYgKCF0aGlzLmFjdGl2ZUxlc3Npb25zPy5sZW5ndGgpIHtcblx0XHRcdHRoaXMubW9kZSA9IHRoaXMuTU9ERS5ORVc7XG5cdFx0XHR0aGlzLmFjdGl2ZUZvcm1EaWFsb2cgPSBwO1xuXHRcdFx0dGhpcy5vbkNlbGxDbGlja0FjdGlvbi5lbWl0KHRoaXMuYWN0aXZlTGVzc2lvbnMpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLm1vZGUgPSB0aGlzLk1PREUuRURJVDtcblx0XHR9XG5cdH1cblxuXHRvblNlbGVjdFRlYWNoTWFuYWdlbWVudCgkZXZlbnQ6IGFueSkge1xuXHRcdHRoaXMuYWN0aXZlVGVhY2hNYW5hZ2VtZW50ID0gdGhpcy5tYWpvcnNUcmFuc2NyaXB0LmZpbmQoKGl0ZW06IGFueSkgPT4gaXRlbS5jb2RlID09PSAkZXZlbnQpO1xuXHR9XG5cblx0Z2V0TWFqb3IoKSB7XG5cdFx0cmV0dXJuIHtcblx0XHRcdFwiY29kZVwiOiBfLmdldCh0aGlzLmFjdGl2ZVRlYWNoTWFuYWdlbWVudCwgJ3RlYWNoTWFuYWdlbWVudC5tYWpvckNvZGUnLCAwKSxcblx0XHRcdFwibmFtZVwiOiBfLmdldCh0aGlzLmFjdGl2ZVRlYWNoTWFuYWdlbWVudCwgJ3RlYWNoTWFuYWdlbWVudC5tYWpvck5hbWUnLCAwKSxcblx0XHR9XG5cdH1cblxuXHRnZXRUdXRvcigpIHtcblx0XHRyZXR1cm4ge1xuXHRcdFx0XCJ1dWlkXCI6IF8uZ2V0KHRoaXMuYWN0aXZlVGVhY2hNYW5hZ2VtZW50LCAndGVhY2hNYW5hZ2VtZW50LnR1dG9yVXVpZCcsIDApLFxuXHRcdFx0XCJuYW1lXCI6IF8uZ2V0KHRoaXMuYWN0aXZlVGVhY2hNYW5hZ2VtZW50LCAndGVhY2hNYW5hZ2VtZW50LnR1dG9yTmFtZScsIDApXG5cdFx0fVxuXHR9XG5cblx0Z2V0Q2xhenooKSB7XG5cdFx0cmV0dXJuIHtcblx0XHRcdFwiY29kZVwiOiBfLmdldCh0aGlzLmFjdGl2ZVRlYWNoTWFuYWdlbWVudCwgJ3RlYWNoTWFuYWdlbWVudC5jbGFzc0lkJywgMCksXG5cdFx0XHRcIm5hbWVcIjogXy5nZXQodGhpcy5hY3RpdmVUZWFjaE1hbmFnZW1lbnQsICd0ZWFjaE1hbmFnZW1lbnQuY2xhc3NOYW1lJywgMCksXG5cdFx0XHRcImdyYWRlQ29kZVwiOiBfLmdldCh0aGlzLmFjdGl2ZVRlYWNoTWFuYWdlbWVudCwgJ3RlYWNoTWFuYWdlbWVudC5ncmFkZUNvZGUnLCAwKSxcblx0XHR9XG5cdH1cblxuXHRjcmVhdGVOZXdMZXNzaW9uKCkge1xuXG5cdFx0aWYgKCF0aGlzLmZvcm0udmFsaWQpIHJldHVybjtcblxuXHRcdGNvbnN0IHBheWxvYWQgPSB7XG5cdFx0XHRcInNjaG9vbFllYXJcIjogdGhpcy5zY2hvb2xZZWFyLFxuXHRcdFx0XCJzZW1lc3RlclwiOiB0aGlzLmZpbHRlckZvcm0uc2VtZXN0ZXIsXG5cdFx0XHRcInRpbWVzbG90SWRcIjogdGhpcy5hY3RpdmVTbG90Py5pZCxcblx0XHRcdFwidGltZXRhYmxlUHJvYmxlbUlkXCI6IHRoaXMudGltZXRhYmxlUHJvYmxlbUlkLFxuXHRcdFx0XCJ0dXRvclwiOiB0aGlzLmdldFR1dG9yKCksXG5cdFx0XHRcIm1ham9yXCI6IHRoaXMuZ2V0TWFqb3IoKSxcblx0XHRcdFwiY2xhenpcIjogdGhpcy5nZXRDbGF6eigpXG5cdFx0fVxuXG5cdFx0dGhpcy5vbkNyZWF0ZU5ld0xlc3Npb24uZW1pdChwYXlsb2FkKTtcblxuXHR9XG5cblx0Z2V0IGlzQXNzaWduZWRUdXRvcigpIHtcblx0XHRyZXR1cm4gdGhpcy5hY3RpdmVUZWFjaE1hbmFnZW1lbnQgJiYgdGhpcy5hY3RpdmVUZWFjaE1hbmFnZW1lbnQ/LnRlYWNoTWFuYWdlbWVudD8udHV0b3JOYW1lO1xuXHR9XG5cblx0Z2V0IGlzVW5Bc3NpZ25lZFR1dG9yKCkge1xuXHRcdHJldHVybiB0aGlzLmFjdGl2ZVRlYWNoTWFuYWdlbWVudCAmJiAhdGhpcy5hY3RpdmVUZWFjaE1hbmFnZW1lbnQ/LnRlYWNoTWFuYWdlbWVudD8udHV0b3JOYW1lO1xuXHR9XG5cblx0Y2xvc2VGb3JtKCkge1xuXHRcdHRoaXMuYWN0aXZlRm9ybURpYWxvZy5jbG9zZSgpO1xuXHR9XG5cblx0cmVtb3ZlTGVzc2lvbkZyb21DZWxsKCkge1xuXHRcdGNvbnN0IGFjdGl2ZUxlc3Npb24gPSB0aGlzLmFjdGl2ZUxlc3Npb25zWzBdO1xuXHRcdHRoaXMub25SZW1vdmVBY3Rpb24uZW1pdChhY3RpdmVMZXNzaW9uKVxuXHR9XG5cblx0bmdPbkRlc3Ryb3koKTogdm9pZCB7XG5cdFx0dGhpcy5kZXN0cm95ZWQkLm5leHQoKTtcblx0XHR0aGlzLmRlc3Ryb3llZCQuY29tcGxldGUoKTtcblx0XHR0aGlzLnJlc2V0VGltZVRhYmxlKCk7XG5cdH1cbn1cbiIsIjxkaXYgY2xhc3M9XCJ0aW1ldGFibGUtdWlcIiBbY2xhc3MuaW4tcHJvY2Vzc2luZ109XCJzaG93UHJvZ3Jlc3NMb2FkaW5nXCI+XG4gIDxkaXYgY2xhc3M9XCJ0aW1ldGFibGUtdWktcHJlZml4LWNvbHVtbiB0aW1ldGFibGUtdWktZGF5LWNvbHVtblwiPlxuICAgIDxkaXYgY2xhc3M9XCJ0aW1ldGFibGUtdWktZGF5LWNvbHVtbi1sZXNzb25cIj5cbiAgICAgIDxkaXZcbiAgICAgICAgY2xhc3M9XCJ0aW1ldGFibGUtdWktZGF5LWxlc3Nvbi1pdGVtXCJcbiAgICAgICAgKm5nRm9yPVwibGV0IGxlc3Nvbk51bSBvZiBkYXlMZXNzaW9uU2xvdHNcIlxuICAgICAgPlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIDxzcGFuPlRp4bq/dCB7eyBsZXNzb25OdW0gKyAxIH19PC9zcGFuPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICA8L2Rpdj5cbiAgPGRpdlxuICAgICpuZ0Zvcj1cImxldCBkYXkgb2Ygb2JqZWN0S2V5cyh0aW1lVGFibGVEYXRhKVwiXG4gICAgY2xhc3M9XCJ0aW1ldGFibGUtdWktZGF5LWNvbHVtblwiXG4gID5cbiAgICA8ZGl2IGNsYXNzPVwidGltZXRhYmxlLXVpLWRheS1jb2x1bW4tbGVzc29uXCI+XG4gICAgICA8ZGl2IGNsYXNzPVwidGltZXRhYmxlLXVpLWRheS1uYW1lXCI+XG4gICAgICAgIHt7IGRheSB8IHRyYW5zbGF0ZSB9fVxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2XG4gICAgICAgIGNsYXNzPVwidGltZXRhYmxlLXVpLWRheS1sZXNzb24taXRlbSB0aW1ldGFibGUtdWktZGF5LWxlc3Nvbi1pdGVtLXZhbHVlXCJcbiAgICAgICAgKm5nRm9yPVwibGV0IHNsb3ROdW0gb2YgZGF5TGVzc2lvblNsb3RzXCJcbiAgICAgID5cbiAgICAgICAgPGRpdlxuICAgICAgICAgIGRuZERyb3B6b25lXG4gICAgICAgICAgW2NsYXNzLnRibC1lZGl0aW5nLW1vZGVdPVwiaXNFbmFibGVBZGp1c3RNb2RlXCJcbiAgICAgICAgICAoZG5kRHJvcCk9XCJvbkRyb3AoJGV2ZW50LCBkYXksIHNsb3ROdW0gKyAxLCB0aW1lU2hpZnQpXCJcbiAgICAgICAgICBbbmdiUG9wb3Zlcl09XCJwb3BDb250ZW50XCJcbiAgICAgICAgICBbYXV0b0Nsb3NlXT1cIidvdXRzaWRlJ1wiXG4gICAgICAgICAgdHJpZ2dlcnM9XCJtYW51YWxcIlxuICAgICAgICAgICNwPVwibmdiUG9wb3ZlclwiXG4gICAgICAgICAgcGxhY2VtZW50PVwiYXV0b1wiXG4gICAgICAgICAgY2xhc3M9XCJ0aW1ldGFibGUtdWktY2VsbC1jb250YWluZXJcIlxuICAgICAgICAgIFtjbGFzcy5lbXB0eS1sZXNzaW9uXT1cIlxuICAgICAgICAgICAgIWdldExlc3NvbkJ5T3JkZXIoZGF5LCBzbG90TnVtICsgMSwgdGltZVNoaWZ0KT8ubGVuZ3RoXG4gICAgICAgICAgXCJcbiAgICAgICAgICBbY2xhc3MuaXMtZGlzYWJsZWRdPVwiIWdldFNsb3QoZGF5LCBzbG90TnVtICsgMSk/LmVuYWJsZWRcIlxuICAgICAgICAgIChjbGljayk9XCJvbkNlbGxDbGljayhwLCBkYXksIHNsb3ROdW0gKyAxLCB0aW1lU2hpZnQpXCJcbiAgICAgICAgPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJkbmQtZHJvcHpvbmUtc2xvdFwiIGRuZFBsYWNlaG9sZGVyUmVmPjwvZGl2PlxuICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICpuZ0Zvcj1cImxldCBsZXNzb24gb2YgZ2V0TGVzc29uQnlPcmRlcihkYXksIHNsb3ROdW0gKyAxLCB0aW1lU2hpZnQpXCJcbiAgICAgICAgICAgIGNsYXNzPVwidGltZXRhYmxlLXVpLWRheS1sZXNzb24taXRlbV9faXRlbVwiXG4gICAgICAgICAgICBbZG5kRHJhZ2dhYmxlXT1cImxlc3NvblwiXG4gICAgICAgICAgICBbZG5kRGlzYWJsZUlmXT1cImRyYWdnYWJsZS5kaXNhYmxlXCJcbiAgICAgICAgICA+XG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICA8aDQ+e3sgbGVzc29uPy5kZXRhaWxzPy5tYWpvci5uYW1lIH19PC9oND5cbiAgICAgICAgICAgICAgPHBcbiAgICAgICAgICAgICAgICBjbGFzcz1cInN1Yi10ZXh0LW9uZVwiXG4gICAgICAgICAgICAgICAgKGNsaWNrKT1cIm9uQ2xpY2tUdXRvck5hbWUobGVzc29uLmRldGFpbHMudHV0b3IpXCJcbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJ0eXBlID09PSAnVFVUT1InXCI+e3tcbiAgICAgICAgICAgICAgICAgIGxlc3Nvbj8uZGV0YWlscz8uY2xhenoubmFtZVxuICAgICAgICAgICAgICAgIH19PC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cInR5cGUgPT09ICdDTEFTUydcIj57e1xuICAgICAgICAgICAgICAgICAgbGVzc29uPy5kZXRhaWxzPy50dXRvci5uYW1lXG4gICAgICAgICAgICAgICAgfX08L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuPC9kaXY+XG48bmctdGVtcGxhdGUgI3BvcENvbnRlbnQ+XG4gIDxkaXYgY2xhc3M9XCJzY2hlZHVsZS1wb3AtY29udGVudFwiICpuZ0lmPVwibW9kZSA9PSBNT0RFLk5FV1wiPlxuICAgIDxkaXYgY2xhc3M9XCJtYi0xXCI+XG4gICAgICA8ZGl2IGNsYXNzPVwic2NoZWR1bGUtcG9wLWNvbnRlbnQtaGVhZGVyXCI+XG4gICAgICAgIDxzcGFuPlRow6ptIHRp4bq/dCBt4bubaTwvc3Bhbj5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBjbGFzcz1cInNjaGVkdWxlLXBvcC1jb250ZW50LWxpbmUgbWItMlwiPjwvZGl2PlxuICAgICAgPGZvcm0gW2Zvcm1Hcm91cF09XCJmb3JtXCIgY2xhc3M9XCJmb3JtXCIgKG5nU3VibWl0KT1cImNyZWF0ZU5ld0xlc3Npb24oKVwiPlxuICAgICAgICA8ZGl2IGNsYXNzPVwiZm9ybS1ncm91cFwiPlxuICAgICAgICAgIDxsYWJlbCBjbGFzcz1cInJlcXVpcmVkXCI+TcO0biBo4buNYzwvbGFiZWw+XG5cbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiZC1ibG9ja1wiPlxuICAgICAgICAgICAgPG5nLXNlbGVjdDJcbiAgICAgICAgICAgICAgZm9ybUNvbnRyb2xOYW1lPVwibWFqb3JDb2RlXCJcbiAgICAgICAgICAgICAgY2xhc3M9XCJ3LTEwMFwiXG4gICAgICAgICAgICAgIHdpZHRoPVwiMTAwJVwiXG4gICAgICAgICAgICAgICh2YWx1ZUNoYW5nZWQpPVwib25TZWxlY3RUZWFjaE1hbmFnZW1lbnQoJGV2ZW50KVwiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9XCItMVwiPlZ1aSBsw7JuZyBjaOG7jW48L29wdGlvbj5cbiAgICAgICAgICAgICAgPG9wdGlvblxuICAgICAgICAgICAgICAgICpuZ0Zvcj1cImxldCBpdGVtIG9mIG1ham9yc1RyYW5zY3JpcHRcIlxuICAgICAgICAgICAgICAgIHZhbHVlPVwie3sgaXRlbS5jb2RlIH19XCJcbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHt7IGl0ZW0udGl0bGUgfX1cbiAgICAgICAgICAgICAgPC9vcHRpb24+XG4gICAgICAgICAgICA8L25nLXNlbGVjdDI+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICAgIDxkaXYgY2xhc3M9XCJmb3JtLWdyb3VwXCIgKm5nSWY9XCJpc0Fzc2lnbmVkVHV0b3JcIj5cbiAgICAgICAgICA8cCBjbGFzcz1cInN1Yi10ZXh0LW9uZVwiPlxuICAgICAgICAgICAgR2nDoW8gdmnDqm46IHt7IGFjdGl2ZVRlYWNoTWFuYWdlbWVudD8udGVhY2hNYW5hZ2VtZW50Py50dXRvck5hbWUgfX1cbiAgICAgICAgICA8L3A+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICAgIDxwIGNsYXNzPVwidW5hc3NpZ25lZF90dXRvclwiICpuZ0lmPVwiaXNVbkFzc2lnbmVkVHV0b3JcIj5cbiAgICAgICAgICBHacOhbyB2acOqbjogQ2jGsGEgxJHGsOG7o2MgcGjDom4gY8O0bmcuXG4gICAgICAgIDwvcD5cblxuICAgICAgICA8ZGl2IGNsYXNzPVwiYnV0dG9uc1wiPlxuICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgIHR5cGU9XCJzdWJtaXRcIlxuICAgICAgICAgICAgW2Rpc2FibGVkXT1cIiFpc0Fzc2lnbmVkVHV0b3JcIlxuICAgICAgICAgICAgY29sb3I9XCJwcmltYXJ5XCJcbiAgICAgICAgICAgIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5XCJcbiAgICAgICAgICA+XG5cdFx0XHRcdFx0XHRMxrB1IHRoYXkgxJHhu5VpXG4gICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgY29sb3I9XCJwcmltYXJ5XCJcbiAgICAgICAgICAgIHR5cGU9XCJidXR0b25cIlxuICAgICAgICAgICAgY2xhc3M9XCJidG5cIlxuICAgICAgICAgICAgKGNsaWNrKT1cImNsb3NlRm9ybSgpXCJcbiAgICAgICAgICA+XG5cdFx0XHRcdFx0XHRI4buneVxuICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZm9ybT5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG5cbiAgPG5nLWNvbnRhaW5lciAqbmdJZj1cIm1vZGUgPT0gTU9ERS5FRElUXCI+XG4gICAgPHNwYW4gKGNsaWNrKT1cInJlbW92ZUxlc3Npb25Gcm9tQ2VsbCgpXCIgcm9sZT1cImJ1dHRvblwiIGNsYXNzPVwiZC1ibG9jayByZW1vdmUtbGVzc2lvblwiPlxuICAgICAgPHN2Z1xuICAgICAgICB3aWR0aD1cIjE0XCJcbiAgICAgICAgaGVpZ2h0PVwiMTRcIlxuICAgICAgICB2aWV3Qm94PVwiMCAwIDE0IDE0XCJcbiAgICAgICAgZmlsbD1cIm5vbmVcIlxuICAgICAgICB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCJcbiAgICAgID5cbiAgICAgICAgPHBhdGhcbiAgICAgICAgICBkPVwiTTUuNzUgMi4yNVYyLjVIOC4yNVYyLjI1QzguMjUgMS45MTg0OCA4LjExODMgMS42MDA1NCA3Ljg4Mzg4IDEuMzY2MTJDNy42NDk0NiAxLjEzMTcgNy4zMzE1MiAxIDcgMUM2LjY2ODQ4IDEgNi4zNTA1NCAxLjEzMTcgNi4xMTYxMiAxLjM2NjEyQzUuODgxNyAxLjYwMDU0IDUuNzUgMS45MTg0OCA1Ljc1IDIuMjVaTTQuNzUgMi41VjIuMjVDNC43NSAxLjY1MzI2IDQuOTg3MDUgMS4wODA5NyA1LjQwOTAxIDAuNjU5MDFDNS44MzA5NyAwLjIzNzA1MyA2LjQwMzI2IDAgNyAwQzcuNTk2NzQgMCA4LjE2OTAzIDAuMjM3MDUzIDguNTkwOTkgMC42NTkwMUM5LjAxMjk1IDEuMDgwOTcgOS4yNSAxLjY1MzI2IDkuMjUgMi4yNVYyLjVIMTNDMTMuMTMyNiAyLjUgMTMuMjU5OCAyLjU1MjY4IDEzLjM1MzYgMi42NDY0NUMxMy40NDczIDIuNzQwMjEgMTMuNSAyLjg2NzM5IDEzLjUgM0MxMy41IDMuMTMyNjEgMTMuNDQ3MyAzLjI1OTc5IDEzLjM1MzYgMy4zNTM1NUMxMy4yNTk4IDMuNDQ3MzIgMTMuMTMyNiAzLjUgMTMgMy41SDEyLjI0NkwxMS4zIDExLjc4NEMxMS4yMzAyIDEyLjM5NDEgMTAuOTM4NCAxMi45NTcyIDEwLjQ4MDEgMTMuMzY1OUMxMC4wMjE4IDEzLjc3NDYgOS40MjkwNyAxNC4wMDAzIDguODE1IDE0SDUuMTg1QzQuNTcwOTMgMTQuMDAwMyAzLjk3ODIzIDEzLjc3NDYgMy41MTk5MyAxMy4zNjU5QzMuMDYxNjIgMTIuOTU3MiAyLjc2OTc2IDEyLjM5NDEgMi43IDExLjc4NEwxLjc1NCAzLjVIMUMwLjg2NzM5MiAzLjUgMC43NDAyMTUgMy40NDczMiAwLjY0NjQ0NyAzLjM1MzU1QzAuNTUyNjc4IDMuMjU5NzkgMC41IDMuMTMyNjEgMC41IDNDMC41IDIuODY3MzkgMC41NTI2NzggMi43NDAyMSAwLjY0NjQ0NyAyLjY0NjQ1QzAuNzQwMjE1IDIuNTUyNjggMC44NjczOTIgMi41IDEgMi41SDQuNzVaTTMuNjk0IDExLjY3QzMuNzM1NzQgMTIuMDM2IDMuOTEwNjggMTIuMzczOCA0LjE4NTQ2IDEyLjYxOUM0LjQ2MDI1IDEyLjg2NDMgNC44MTU2NyAxMi45OTk5IDUuMTg0IDEzSDguODE1NUM5LjE4MzgzIDEyLjk5OTkgOS41MzkyNiAxMi44NjQzIDkuODE0MDQgMTIuNjE5QzEwLjA4ODggMTIuMzczOCAxMC4yNjM4IDEyLjAzNiAxMC4zMDU1IDExLjY3TDExLjI0IDMuNUgyLjc2MDVMMy42OTQgMTEuNjdaTTUuNSA1LjI1QzUuNjMyNjEgNS4yNSA1Ljc1OTc5IDUuMzAyNjggNS44NTM1NSA1LjM5NjQ1QzUuOTQ3MzIgNS40OTAyMSA2IDUuNjE3MzkgNiA1Ljc1VjEwLjc1QzYgMTAuODgyNiA1Ljk0NzMyIDExLjAwOTggNS44NTM1NSAxMS4xMDM2QzUuNzU5NzkgMTEuMTk3MyA1LjYzMjYxIDExLjI1IDUuNSAxMS4yNUM1LjM2NzM5IDExLjI1IDUuMjQwMjEgMTEuMTk3MyA1LjE0NjQ1IDExLjEwMzZDNS4wNTI2OCAxMS4wMDk4IDUgMTAuODgyNiA1IDEwLjc1VjUuNzVDNSA1LjYxNzM5IDUuMDUyNjggNS40OTAyMSA1LjE0NjQ1IDUuMzk2NDVDNS4yNDAyMSA1LjMwMjY4IDUuMzY3MzkgNS4yNSA1LjUgNS4yNVpNOSA1Ljc1QzkgNS42MTczOSA4Ljk0NzMyIDUuNDkwMjEgOC44NTM1NSA1LjM5NjQ1QzguNzU5NzkgNS4zMDI2OCA4LjYzMjYxIDUuMjUgOC41IDUuMjVDOC4zNjczOSA1LjI1IDguMjQwMjEgNS4zMDI2OCA4LjE0NjQ1IDUuMzk2NDVDOC4wNTI2OCA1LjQ5MDIxIDggNS42MTczOSA4IDUuNzVWMTAuNzVDOCAxMC44ODI2IDguMDUyNjggMTEuMDA5OCA4LjE0NjQ1IDExLjEwMzZDOC4yNDAyMSAxMS4xOTczIDguMzY3MzkgMTEuMjUgOC41IDExLjI1QzguNjMyNjEgMTEuMjUgOC43NTk3OSAxMS4xOTczIDguODUzNTUgMTEuMTAzNkM4Ljk0NzMyIDExLjAwOTggOSAxMC44ODI2IDkgMTAuNzVWNS43NVpcIlxuICAgICAgICAgIGZpbGw9XCIjRDkzQTNBXCJcbiAgICAgICAgLz5cbiAgICAgIDwvc3ZnPlxuXG4gICAgICBYb8OhIHRp4bq/dFxuICAgIDwvc3Bhbj5cbiAgPC9uZy1jb250YWluZXI+XG48L25nLXRlbXBsYXRlPlxuIl19